var e,t,s,a,r,n,i,l=Object.defineProperty,o=e=>{throw TypeError(e)},d=(e,t,s)=>((e,t,s)=>t in e?l(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s)(e,"symbol"!=typeof t?t+"":t,s),c=(e,t,s)=>t.has(e)||o("Cannot "+s),m=(e,t,s)=>(c(e,t,"read from private field"),s?s.call(e):t.get(e)),h=(e,t,s)=>t.has(e)?o("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,s),u=(e,t,s,a)=>(c(e,t,"write to private field"),a?a.call(e,s):t.set(e,s),s);import{r as x,a as p}from"./react-vendor-VIAh7PwP.js";import{S as g,U as f,M as b,P as v,a as j,C as w,b as y,c as N,d as T,e as S,f as C,g as E,R as k,Z as M,h as R,i as A,F as L,j as P,X as F,A as _,k as O,l as D,W as U,D as I,m as $,n as V,L as B,o as z,p as q,q as W,r as K,s as G}from"./lucide-DcZH2Lbf.js";import{g as Y}from"./utils-Btq9dNEW.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var X={exports:{}},H={},J=x,Z=Symbol.for("react.element"),Q=Symbol.for("react.fragment"),ee=Object.prototype.hasOwnProperty,te=J.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,se={key:!0,ref:!0,__self:!0,__source:!0};function ae(e,t,s){var a,r={},n=null,i=null;for(a in void 0!==s&&(n=""+s),void 0!==t.key&&(n=""+t.key),void 0!==t.ref&&(i=t.ref),t)ee.call(t,a)&&!se.hasOwnProperty(a)&&(r[a]=t[a]);if(e&&e.defaultProps)for(a in t=e.defaultProps)void 0===r[a]&&(r[a]=t[a]);return{$$typeof:Z,type:e,key:n,ref:i,props:r,_owner:te.current}}H.Fragment=Q,H.jsx=ae,H.jsxs=ae,X.exports=H;var re,ne=X.exports,ie=p;re=ie.createRoot,ie.hydrateRoot;const le=({onAudioLoad:e,isLoading:t})=>{const s=x.useCallback(t=>{var s;const a=null==(s=t.target.files)?void 0:s[0];if(!a)return;if(!a.type.startsWith("audio/"))return void alert("Please select an audio file");const r=URL.createObjectURL(a),n=new Audio(r);n.addEventListener("loadedmetadata",()=>{const t={file:a,url:r,duration:n.duration,name:a.name};e(t)}),n.load()},[e]),a=x.useCallback(e=>{e.preventDefault();const t=e.dataTransfer.files[0];if(t&&t.type.startsWith("audio/")){s({target:{files:[t]}})}},[s]),r=x.useCallback(e=>{e.preventDefault()},[]);return ne.jsxs("div",{className:"text-center",children:[ne.jsxs("div",{className:"mb-12",children:[ne.jsxs("div",{className:"flex items-center justify-center space-x-4 mb-6",children:[ne.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-blue-500 to-purple-600 rounded-2xl flex items-center justify-center shadow-2xl",children:ne.jsx(g,{className:"w-8 h-8 text-white"})}),ne.jsxs("div",{className:"text-left",children:[ne.jsx("h1",{className:"text-4xl font-bold text-white mb-2",children:"Beat-Synced Video Templates"}),ne.jsx("p",{className:"text-xl text-slate-400",children:"Create perfectly timed cuts for your Snapcut projects"})]})]}),ne.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 max-w-4xl mx-auto mb-12",children:[ne.jsxs("div",{className:"bg-slate-800/50 backdrop-blur-sm rounded-xl p-6 border border-slate-700/50",children:[ne.jsx("div",{className:"w-12 h-12 bg-blue-500/20 rounded-xl flex items-center justify-center mb-4 mx-auto",children:ne.jsx(f,{className:"w-6 h-6 text-blue-400"})}),ne.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"Upload Audio"}),ne.jsx("p",{className:"text-sm text-slate-400",children:"Import your music track and let our AI detect the beats automatically"})]}),ne.jsxs("div",{className:"bg-slate-800/50 backdrop-blur-sm rounded-xl p-6 border border-slate-700/50",children:[ne.jsx("div",{className:"w-12 h-12 bg-orange-500/20 rounded-xl flex items-center justify-center mb-4 mx-auto",children:ne.jsx(b,{className:"w-6 h-6 text-orange-400"})}),ne.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"Add Cuts"}),ne.jsx("p",{className:"text-sm text-slate-400",children:"Place cuts on the timeline, synced to the beat for perfect timing"})]}),ne.jsxs("div",{className:"bg-slate-800/50 backdrop-blur-sm rounded-xl p-6 border border-slate-700/50",children:[ne.jsx("div",{className:"w-12 h-12 bg-green-500/20 rounded-xl flex items-center justify-center mb-4 mx-auto",children:ne.jsx(g,{className:"w-6 h-6 text-green-400"})}),ne.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"Export"}),ne.jsx("p",{className:"text-sm text-slate-400",children:"Download your Snapcut project file and trimmed audio"})]})]})]}),ne.jsx("div",{className:"relative border-2 border-dashed border-slate-600 hover:border-blue-500 rounded-2xl p-12 transition-all duration-300 bg-slate-800/30 backdrop-blur-sm hover:bg-slate-800/50 group",onDrop:a,onDragOver:r,children:ne.jsxs("div",{className:"flex flex-col items-center space-y-6",children:[ne.jsxs("div",{className:"relative",children:[ne.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-blue-500 to-purple-600 rounded-2xl flex items-center justify-center shadow-2xl group-hover:scale-110 transition-transform duration-300",children:t?ne.jsx("div",{className:"w-8 h-8 border-2 border-white border-t-transparent rounded-full animate-spin"}):ne.jsx(b,{className:"w-10 h-10 text-white"})}),!t&&ne.jsx("div",{className:"absolute -top-2 -right-2 w-8 h-8 bg-orange-500 rounded-full flex items-center justify-center shadow-lg",children:ne.jsx(f,{className:"w-4 h-4 text-white"})})]}),ne.jsxs("div",{className:"text-center",children:[ne.jsx("h3",{className:"text-2xl font-bold text-white mb-3",children:t?"Processing Your Audio...":"Upload Your Music"}),ne.jsx("p",{className:"text-slate-400 text-lg mb-6 max-w-md",children:t?"Analyzing beats and preparing your timeline...":"Drag and drop an audio file or click to browse"})]}),!t&&ne.jsxs("label",{className:"cursor-pointer group",children:[ne.jsx("input",{type:"file",accept:"audio/*",onChange:s,className:"hidden",disabled:t}),ne.jsxs("div",{className:"flex items-center space-x-3 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 px-8 py-4 rounded-xl transition-all duration-200 shadow-lg hover:shadow-xl transform hover:scale-105",children:[ne.jsx(f,{className:"w-5 h-5 text-white"}),ne.jsx("span",{className:"font-semibold text-white text-lg",children:"Choose Audio File"})]})]}),ne.jsxs("div",{className:"flex flex-wrap justify-center gap-2 text-sm text-slate-500",children:[ne.jsx("span",{className:"bg-slate-700/50 px-3 py-1 rounded-full",children:"MP3"}),ne.jsx("span",{className:"bg-slate-700/50 px-3 py-1 rounded-full",children:"WAV"}),ne.jsx("span",{className:"bg-slate-700/50 px-3 py-1 rounded-full",children:"FLAC"}),ne.jsx("span",{className:"bg-slate-700/50 px-3 py-1 rounded-full",children:"M4A"})]})]})})]})},oe=({audioFile:e,currentTime:t,isPlaying:s,onTimeUpdate:a,onPlayPause:r,startTime:n,endTime:i,isLooping:l})=>{const o=x.useRef(null),[d,c]=x.useState(0);x.useEffect(()=>{const e=o.current;if(!e)return;const t=()=>{const t=e.currentTime;a(t)},s=()=>{c(e.duration)};return e.addEventListener("timeupdate",t),e.addEventListener("loadedmetadata",s),()=>{e.removeEventListener("timeupdate",t),e.removeEventListener("loadedmetadata",s)}},[a]),x.useEffect(()=>{const e=o.current;if(!e)return;const t=()=>{e.currentTime>=i&&(e.currentTime=n,a(n),l||(e.pause(),r()))};return e.addEventListener("timeupdate",t),()=>{e.removeEventListener("timeupdate",t)}},[l,n,i,a,r,s]),x.useEffect(()=>{const e=o.current;e&&Math.abs(e.currentTime-t)>.1&&(e.currentTime=t)},[t]),x.useEffect(()=>{const e=o.current;e&&(s?e.play().catch(console.error):e.pause())},[s]);const m=e=>`${Math.floor(e/60)}:${Math.floor(e%60).toString().padStart(2,"0")}`;return ne.jsxs("div",{className:"flex items-center space-x-3",children:[ne.jsx("audio",{ref:o,src:e.url,preload:"metadata"}),ne.jsx("button",{onClick:r,className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 rounded-xl flex items-center justify-center transition-all duration-200 shadow-lg hover:shadow-xl transform hover:scale-105",children:s?ne.jsx(v,{className:"w-6 h-6 text-white"}):ne.jsx(j,{className:"w-6 h-6 text-white ml-1"})}),ne.jsxs("div",{className:"text-sm text-slate-300 bg-slate-700/50 rounded-lg px-3 py-2",children:[ne.jsx("span",{className:"font-mono text-white font-medium",children:m(t)}),ne.jsx("span",{className:"text-slate-500 mx-2",children:"/"}),ne.jsx("span",{className:"font-mono text-slate-400",children:m(d)})]})]})},de=({audioFile:e,currentTime:t,isPlaying:s,beatMarkers:a,cutMarkers:r,startTime:n,endTime:i,onBeatDetected:l,onAddCut:o,onRemoveCut:d,onMoveCut:c,onSeek:m,onTrimChange:h,zoom:u,onZoomChange:p,onStop:g,isLooping:f,onToggleLoop:b,onRandomMode:v})=>{const j=x.useRef(null),A=x.useRef(null),L=x.useRef(null),[P,F]=x.useState(null),[_,O]=x.useState(!1),[D,U]=x.useState(null),[I,$]=x.useState(0),[V,B]=x.useState(null),[z,q]=x.useState(!1);x.useEffect(()=>{(async()=>{if(e.file){O(!0);try{const t=new AudioContext,s=await e.file.arrayBuffer(),a=(await t.decodeAudioData(s)).getChannelData(0),r=Math.min(12e3,a.length),n=Math.floor(a.length/r),i=new Float32Array(r);for(let e=0;e<r;e++){let t=0;for(let s=0;s<n;s++){const r=e*n+s;r<a.length&&(t+=Math.abs(a[r]))}i[e]=t/n}F(i);const o=[],d=.08,c=.15,m=new Float32Array(r);for(let e=2;e<r-2;e++)m[e]=(i[e-2]+i[e-1]+i[e]+i[e+1]+i[e+2])/5;for(let l=3;l<m.length-3;l++){const t=l/r*e.duration,s=m[l];if(s>d&&s>m[l-1]&&s>m[l+1]&&s>m[l-2]&&s>m[l+2]){const e=o[o.length-1];(!e||t-e.time>c)&&o.push({time:t,intensity:s,type:s>.25?"strong":s>.15?"medium":"weak"})}}l(o),t.close()}catch(t){}finally{O(!1)}}})()},[e,l]);const W=x.useCallback(()=>{const t=e.duration/u,s=Math.max(0,e.duration-t),a=Math.max(0,Math.min(s,I));return{startTime:a,endTime:a+t,duration:t}},[e.duration,u,I]);x.useEffect(()=>{if(s&&u>1){const{startTime:s,endTime:a}=W(),r=.1*(a-s);if(t<s+r||t>a-r){const r=Math.max(0,t-(a-s)/2),n=Math.max(0,e.duration-(a-s));$(Math.min(n,r))}}},[t,s,u,e.duration,W]);const K=x.useCallback(()=>{const s=j.current;if(!s||!P)return;const a=s.getContext("2d");if(!a)return;const l=s.getBoundingClientRect(),o=l.width,d=l.height,c=window.devicePixelRatio||1;s.width=o*c,s.height=d*c,s.style.width=o+"px",s.style.height=d+"px",a.scale(c,c),a.clearRect(0,0,o,d),a.imageSmoothingEnabled=!0,a.imageSmoothingQuality="high";const{startTime:m,endTime:h}=W(),u=P.length,x=Math.floor(m/e.duration*u),p=Math.floor(h/e.duration*u)-x;if(p<=0)return;const g=o/p,f=Math.max(0,(n-m)/(h-m)*o),b=Math.min(o,(i-m)/(h-m)*o);a.fillStyle="rgba(0, 0, 0, 0.6)",a.fillRect(0,0,f,d),a.fillRect(b,0,o-b,d),a.fillStyle="rgba(59, 130, 246, 0.05)",a.fillRect(f,0,b-f,d),n>=m&&n<=h&&(a.strokeStyle="#10B981",a.lineWidth=2,a.beginPath(),a.moveTo(f,0),a.lineTo(f,d),a.stroke(),a.fillStyle="#10B981",a.shadowColor="rgba(0, 0, 0, 0.8)",a.shadowBlur=2,a.font="bold 10px Inter, sans-serif",a.textAlign="left",a.fillText("IN",f+4,15),a.shadowColor="transparent",a.shadowBlur=0),i>=m&&i<=h&&(a.strokeStyle="#EF4444",a.lineWidth=2,a.beginPath(),a.moveTo(b,0),a.lineTo(b,d),a.stroke(),a.fillStyle="#EF4444",a.shadowColor="rgba(0, 0, 0, 0.8)",a.shadowBlur=2,a.font="bold 10px Inter, sans-serif",a.textAlign="right",a.fillText("OUT",b-4,15),a.shadowColor="transparent",a.shadowBlur=0),a.fillStyle="#3B82F6",a.beginPath();const v=d/2;a.moveTo(0,v);for(let e=0;e<p&&x+e<u;e++){const t=e*g,s=v-(P[x+e]||0)*d*.4;0===e?a.moveTo(t,s):a.lineTo(t,s)}for(let e=p-1;e>=0&&x+e<u;e--){const t=e*g,s=v+(P[x+e]||0)*d*.4;a.lineTo(t,s)}if(a.closePath(),a.fill(),a.strokeStyle="rgba(59, 130, 246, 0.3)",a.lineWidth=1,a.beginPath(),a.moveTo(0,v),a.lineTo(o,v),a.stroke(),r.forEach((e,t)=>{if(e.time>=m&&e.time<=h){const s=(e.time-m)/(h-m)*o;a.strokeStyle=e.color,a.lineWidth=3,a.beginPath(),a.moveTo(s,0),a.lineTo(s,d),a.stroke(),a.fillStyle=e.color,a.shadowColor="rgba(0, 0, 0, 0.8)",a.shadowBlur=4,a.shadowOffsetX=1,a.shadowOffsetY=1,a.font="bold 14px Inter, sans-serif",a.textAlign="center",a.fillText((t+1).toString(),s,20),a.shadowColor="transparent",a.shadowBlur=0,a.shadowOffsetX=0,a.shadowOffsetY=0}}),r.forEach((e,t)=>{if(e.time>=m&&e.time<=h){const s=(e.time-m)/(h-m)*o;a.strokeStyle=e.color,a.lineWidth=3,a.beginPath(),a.moveTo(s,0),a.lineTo(s,d),a.stroke(),a.fillStyle=e.color,a.shadowColor="rgba(0, 0, 0, 0.8)",a.shadowBlur=4,a.shadowOffsetX=1,a.shadowOffsetY=1,a.font="bold 14px Inter, sans-serif",a.textAlign="center",a.fillText((t+1).toString(),s,20),a.shadowColor="transparent",a.shadowBlur=0,a.shadowOffsetX=0,a.shadowOffsetY=0,a.fillStyle=e.color,a.fillRect(s-6,d-15,12,15)}}),t>=m&&t<=h){const e=(t-m)/(h-m)*o;a.strokeStyle="#10B981",a.lineWidth=3,a.beginPath(),a.moveTo(e,0),a.lineTo(e,d),a.stroke()}n>=m&&n<=h&&(a.fillStyle="trim-start"===(null==D?void 0:D.type)?"#059669":"#10B981",a.fillRect(f-6,d-12,12,12)),i>=m&&i<=h&&(a.fillStyle="trim-end"===(null==D?void 0:D.type)?"#DC2626":"#EF4444",a.fillRect(b-6,d-12,12,12))},[P,r,t,e.duration,n,i,W,D]);x.useEffect(()=>{K()},[K]);const G=x.useCallback(t=>{if(z)return void q(!1);const s=j.current;if(!s)return;const a=s.getBoundingClientRect(),l=t.clientX-a.left,{startTime:o,endTime:d}=W(),c=o+l/a.width*(d-o),u=Math.max(0,(n-o)/(d-o)*a.width),x=Math.min(a.width,(i-o)/(d-o)*a.width);if(Math.abs(l-u)<12&&t.clientY>a.height-20)return U({type:"trim-start"}),void q(!1);if(Math.abs(l-x)<12&&t.clientY>a.height-20)return U({type:"trim-end"}),void q(!1);const p=r.find(e=>{if(e.time>=o&&e.time<=d){const s=(e.time-o)/(d-o)*a.width;return Math.abs(l-s)<12&&t.clientY>a.height-20}return!1});return p?(U({type:"cut",id:p.id}),void q(!1)):"in"===V?(h(c,i),void B(null)):"out"===V?(h(n,c),void B(null)):void m(Math.max(0,Math.min(e.duration,c)))},[e.duration,n,i,m,h,W,r,z,V]),Y=x.useCallback(t=>{var s;if(z)return void q(!1);const n=null==(s=A.current)?void 0:s.getBoundingClientRect();if(!n)return;const i=t.clientX-n.left,{startTime:l,endTime:c}=W(),m=l+i/n.width*(c-l),h=r.find(e=>{const t=(e.time-l)/(c-l)*n.width;return Math.abs(i-t)<10});if(2===t.detail&&h)d(h.id);else if(1===t.detail&&!h){const t=.1,s=a.find(e=>Math.abs(e.time-m)<t),r=s?s.time:m;o(Math.max(0,Math.min(e.duration,r)))}},[e.duration,a,r,o,d,W,z]),X=x.useCallback(t=>{if(!D)return;const s=j.current;if(!s)return;const a=s.getBoundingClientRect(),r=t.clientX-a.left;z||q(!0);const{startTime:l,endTime:o}=W(),d=Math.max(0,Math.min(e.duration,l+r/a.width*(o-l)));"trim-start"===D.type&&d<i?h(d,i):"trim-end"===D.type&&d>n?h(n,d):"cut"===D.type&&D.id&&c(D.id,d)},[D,z,e.duration,n,i,h,c,W]),H=x.useCallback(()=>{U(null)},[]);x.useCallback(()=>{U(null)},[]);const J=x.useCallback(t=>{if(t.preventDefault(),t.stopPropagation(),t.ctrlKey||t.metaKey){const e=t.deltaY>0?-.5:.5,s=Math.max(.5,Math.min(10,u+e));p(s)}else{const s=0!==t.deltaX?t.deltaX:t.deltaY,{duration:a}=W(),r=.05*a,n=I+(s>0?r:-r),i=Math.max(0,e.duration-a);$(Math.max(0,Math.min(i,n)))}},[I,e.duration,W,u,p]),Z=x.useCallback(()=>{o(t)},[t,o]),Q=x.useCallback(()=>{h(t,i)},[t,i,h]),ee=x.useCallback(()=>{h(n,t)},[n,t,h]),te=x.useCallback(t=>{const{duration:s}=W(),a=.1*s,r=I+("right"===t?a:-a),n=Math.max(0,e.duration-s);$(Math.max(0,Math.min(n,r)))},[I,e.duration,W]);return ne.jsxs("div",{className:"space-y-4 p-6",children:[ne.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-4",children:[ne.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[ne.jsx("button",{onClick:()=>te("left"),className:"p-2 bg-slate-700 hover:bg-slate-600 rounded-lg transition-colors",children:ne.jsx(w,{className:"w-4 h-4"})}),ne.jsx("button",{onClick:()=>te("right"),className:"p-2 bg-slate-700 hover:bg-slate-600 rounded-lg transition-colors",children:ne.jsx(y,{className:"w-4 h-4"})}),ne.jsx("div",{className:"w-px h-6 bg-slate-600"}),ne.jsxs("button",{onClick:Q,className:"flex items-center space-x-2 bg-green-600 hover:bg-green-700 px-3 py-2 rounded-lg transition-colors text-sm font-medium",children:[ne.jsx(N,{className:"w-4 h-4"}),ne.jsx("span",{children:"Set IN"})]}),ne.jsxs("button",{onClick:ee,className:"flex items-center space-x-2 bg-red-500 hover:bg-red-600 px-3 py-2 rounded-lg transition-colors text-sm font-medium",children:[ne.jsx(T,{className:"w-4 h-4"}),ne.jsx("span",{children:"Set OUT"})]}),ne.jsxs("button",{onClick:v,className:"flex items-center space-x-2 bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 px-3 py-2 rounded-lg transition-all duration-200 text-sm font-medium shadow-lg hover:shadow-xl transform hover:scale-105",children:[ne.jsx(S,{className:"w-4 h-4"}),ne.jsx("span",{children:"Random"})]}),ne.jsx("div",{className:"w-px h-6 bg-slate-600"}),ne.jsxs("button",{onClick:Z,className:"flex items-center space-x-2 bg-orange-600 hover:bg-orange-700 px-3 py-2 rounded-lg transition-colors text-sm font-medium",children:[ne.jsx(C,{className:"w-4 h-4"}),ne.jsx("span",{children:"Cut Here"})]}),ne.jsx("div",{className:"w-px h-6 bg-slate-600"}),ne.jsxs("button",{onClick:g,className:"flex items-center space-x-2 bg-slate-600 hover:bg-slate-500 px-3 py-2 rounded-lg transition-colors text-sm font-medium",children:[ne.jsx(E,{className:"w-4 h-4"}),ne.jsx("span",{children:"Stop"})]}),ne.jsxs("button",{onClick:b,className:"flex items-center space-x-2 px-3 py-2 rounded-lg transition-colors text-sm font-medium "+(f?"bg-blue-500 hover:bg-blue-600":"bg-slate-600 hover:bg-slate-500"),children:[ne.jsx(k,{className:"w-4 h-4"}),ne.jsx("span",{children:"Loop"})]})]}),ne.jsxs("div",{className:"flex items-center space-x-3",children:[ne.jsx("div",{className:"w-px h-6 bg-slate-600"}),ne.jsx("button",{onClick:()=>p(Math.max(.5,u-.5)),className:"p-2 bg-slate-700 hover:bg-slate-600 rounded-lg transition-colors",children:ne.jsx(M,{className:"w-4 h-4"})}),ne.jsxs("span",{className:"text-sm text-slate-400 min-w-[60px] text-center font-mono",children:[u.toFixed(1),"x"]}),ne.jsx("button",{onClick:()=>p(Math.min(10,u+.5)),className:"p-2 bg-slate-700 hover:bg-slate-600 rounded-lg transition-colors",children:ne.jsx(R,{className:"w-4 h-4"})})]})]}),ne.jsx("div",{className:"bg-slate-700/30 rounded-xl p-4 border border-slate-600/30",children:ne.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-xs text-slate-400",children:[ne.jsxs("div",{className:"flex items-center space-x-2",children:[ne.jsx("kbd",{className:"bg-slate-600 px-2 py-1 rounded text-xs font-mono",children:"Space"}),ne.jsx("span",{children:"Play/Pause"})]}),ne.jsxs("div",{className:"flex items-center space-x-2",children:[ne.jsx("kbd",{className:"bg-slate-600 px-2 py-1 rounded text-xs font-mono",children:"C"}),ne.jsx("span",{children:"Add Cut"})]}),ne.jsxs("div",{className:"flex items-center space-x-2",children:[ne.jsx("kbd",{className:"bg-slate-600 px-2 py-1 rounded text-xs font-mono",children:"I"}),ne.jsx("span",{children:"Set IN"})]}),ne.jsxs("div",{className:"flex items-center space-x-2",children:[ne.jsx("kbd",{className:"bg-slate-600 px-2 py-1 rounded text-xs font-mono",children:"O"}),ne.jsx("span",{children:"Set OUT"})]}),ne.jsxs("div",{className:"flex items-center space-x-2",children:[ne.jsx("kbd",{className:"bg-slate-600 px-2 py-1 rounded text-xs font-mono",children:"←/→"}),ne.jsx("span",{children:"Navigate"})]}),ne.jsxs("div",{className:"flex items-center space-x-2",children:[ne.jsx("kbd",{className:"bg-slate-600 px-2 py-1 rounded text-xs font-mono",children:"Scroll"}),ne.jsx("span",{children:"Move Timeline"})]}),ne.jsxs("div",{className:"flex items-center space-x-2",children:[ne.jsx("kbd",{className:"bg-slate-600 px-2 py-1 rounded text-xs font-mono",children:"Ctrl+Scroll"}),ne.jsx("span",{children:"Zoom"})]}),ne.jsxs("div",{className:"flex items-center space-x-2",children:[ne.jsx("kbd",{className:"bg-slate-600 px-2 py-1 rounded text-xs font-mono",children:"L"}),ne.jsx("span",{children:"Toggle Loop"})]})]})}),ne.jsxs("div",{ref:L,className:"bg-slate-800/50 rounded-xl border border-slate-700/50 overflow-hidden shadow-lg",onWheel:J,children:[_&&ne.jsxs("div",{className:"p-4 flex items-center justify-center space-x-2 text-blue-400",children:[ne.jsx("div",{className:"w-4 h-4 border-2 border-blue-400 border-t-transparent rounded-full animate-spin"}),ne.jsx("span",{className:"text-sm",children:"Analyzing beats..."})]}),ne.jsx("div",{ref:A,className:"h-10 bg-slate-700/50 border-b border-slate-600/50 relative "+(V?"cursor-crosshair":"cursor-pointer"),onClick:Y,onMouseMove:X,onMouseUp:H,onMouseLeave:H,children:ne.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-xs text-slate-400 font-medium",children:V?`Click to set ${V.toUpperCase()} point`:"Click to add cuts • Drag handles at bottom to move"})}),ne.jsx("div",{className:"relative",children:ne.jsx("canvas",{ref:j,className:"w-full h-56 block "+(V?"cursor-crosshair":D?"cursor-grabbing":"cursor-pointer"),onClick:G,onMouseMove:X,onMouseUp:H,onMouseLeave:H,style:{imageRendering:"auto"}})})]})]})},ce=({video:e,planIndex:t,audioDuration:s,planDuration:a,onTrimChange:r,onClose:n})=>{const i=x.useRef(null),l=x.useRef(null),[o,d]=x.useState(0),[c,m]=x.useState(!1),h=a,[u,p]=x.useState(0),g=u,f=Math.min(u+h,e.duration),[b,w]=x.useState(!1),[y,N]=x.useState(null);x.useEffect(()=>{const e=i.current;if(!e)return;const t=()=>{w(!0);const t=Math.max(0,e.duration-h);p(Math.min(0,t))},s=()=>{d(e.currentTime)},a=()=>{m(!1),e.currentTime>=f&&(e.currentTime=g,d(g))};return e.addEventListener("loadedmetadata",t),e.addEventListener("timeupdate",s),e.addEventListener("ended",a),()=>{e.removeEventListener("loadedmetadata",t),e.removeEventListener("timeupdate",s),e.removeEventListener("ended",a)}},[s,f,g]),x.useEffect(()=>{const e=i.current;e&&b&&o>=f&&c&&(e.currentTime=g,d(g))},[o,f,g,c,b]);const T=x.useCallback(()=>{const e=i.current;e&&(c?e.pause():(o>=f&&(e.currentTime=g),e.play()),m(!c))},[c,o,f,g]),S=x.useCallback(e=>{const t=i.current;if(!t)return;const s=Math.max(g,Math.min(f,e));t.currentTime=s,d(s)},[g,f]),E=x.useCallback(e=>{const t=i.current;if(!t)return;const s=Math.max(0,t.duration-h),a=Math.max(0,Math.min(e,s));p(a);if(o<a||o>a+h){const e=a+h/2;t.currentTime=e,d(e)}},[h,o]),M=x.useCallback(e=>{if(!l.current||!b||!i.current)return;const t=l.current.getBoundingClientRect(),s=(e.clientX-t.left)/t.width*i.current.duration;S(s)},[b,S]),R=x.useCallback(()=>{N("start")},[]),A=x.useCallback(e=>{if(!y||!l.current||!i.current)return;const t=l.current.getBoundingClientRect(),s=e.clientX-t.left,a=Math.max(0,Math.min(1,s/t.width))*i.current.duration;E(a)},[y,E]),L=x.useCallback(()=>{N(null)},[]),P=x.useCallback(()=>{r(t,g,f),n()},[t,g,f,r,n]),F=x.useCallback(()=>{const e=i.current;e&&(p(0),d(0),e.currentTime=0)},[]),_=x.useCallback(()=>{r(t,g,f),n()},[t,g,f,r,n]),O=e=>{const t=Math.floor(e/60),s=Math.floor(e%60),a=Math.floor(e%1*100);return`${t}:${s.toString().padStart(2,"0")}.${a.toString().padStart(2,"0")}`},D=f-g,U=b&&i.current?o/i.current.duration*100:0,I=b&&i.current?g/i.current.duration*100:0,$=b&&i.current?f/i.current.duration*100:100,V=b&&i.current?h/i.current.duration*100:10;return ne.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:ne.jsxs("div",{className:"bg-slate-800 rounded-2xl border border-slate-700 max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[ne.jsx("div",{className:"p-6 border-b border-slate-700",children:ne.jsxs("div",{className:"flex items-center justify-between",children:[ne.jsxs("div",{children:[ne.jsxs("h2",{className:"text-xl font-semibold text-white mb-1",children:["Trim Video - Plan ",t]}),ne.jsx("p",{className:"text-sm text-slate-400",children:e.title})]}),ne.jsx("button",{onClick:_,className:"text-slate-400 hover:text-white transition-colors text-xl hover:bg-slate-700 rounded-full w-8 h-8 flex items-center justify-center",title:"Save and close",children:"✕"})]})}),ne.jsxs("div",{className:"p-6",children:[ne.jsxs("div",{className:"relative aspect-[9/16] max-h-96 mx-auto bg-black rounded-xl overflow-hidden mb-6",children:[ne.jsx("video",{ref:i,src:e.videoUrl,className:"w-full h-full object-cover",crossOrigin:"anonymous",playsInline:!0}),ne.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent",children:ne.jsx("div",{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2",children:ne.jsx("button",{onClick:T,disabled:!b,className:"w-12 h-12 bg-white/20 backdrop-blur-sm rounded-full flex items-center justify-center text-white hover:bg-white/30 transition-colors disabled:opacity-50",children:c?ne.jsx(v,{className:"w-6 h-6"}):ne.jsx(j,{className:"w-6 h-6 ml-1"})})})})]}),ne.jsxs("div",{className:"space-y-4",children:[ne.jsxs("div",{ref:l,className:"relative h-16 bg-slate-700 rounded-lg cursor-pointer",onClick:M,onMouseMove:A,onMouseUp:L,onMouseLeave:L,children:[ne.jsx("div",{className:"absolute top-0 left-0 h-full bg-blue-500/30 rounded-lg transition-all duration-100",style:{width:`${U}%`}}),ne.jsx("div",{className:"absolute top-0 h-full bg-green-500/20 border-l-2 border-r-2 border-green-500",style:{left:`${I}%`,width:$-I+"%"}}),ne.jsx("div",{className:"absolute top-0 w-full h-full cursor-grab active:cursor-grabbing hover:bg-green-500/10 transition-colors flex items-center justify-center",style:{left:`${I}%`,width:`${Math.min(V,100-I)}%`},onMouseDown:R,title:`Drag to move zone (${h.toFixed(1)}s)`,children:ne.jsxs("div",{className:"text-white text-xs font-bold bg-green-500/80 px-2 py-1 rounded backdrop-blur",children:[h.toFixed(1),"s"]})}),ne.jsx("div",{className:"absolute top-0 w-1 h-full bg-white shadow-lg",style:{left:`${U}%`}})]}),ne.jsxs("div",{className:"flex justify-between items-center text-sm",children:[ne.jsxs("div",{className:"space-y-1",children:[ne.jsxs("div",{className:"text-slate-400",children:["Current: ",ne.jsx("span",{className:"text-white font-mono",children:O(o)})]}),ne.jsxs("div",{className:"text-slate-400",children:["Duration: ",ne.jsx("span",{className:"text-white font-mono",children:O(D)})]})]}),ne.jsxs("div",{className:"space-y-1 text-right",children:[ne.jsxs("div",{className:"text-green-400",children:["Start: ",ne.jsx("span",{className:"text-white font-mono",children:O(g)})]}),ne.jsxs("div",{className:"text-red-400",children:["End: ",ne.jsx("span",{className:"text-white font-mono",children:O(f)})]})]})]}),ne.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[ne.jsxs("div",{children:[ne.jsx("label",{className:"block text-sm font-medium text-slate-400 mb-1",children:"Zone Start (s)"}),ne.jsx("input",{type:"number",min:"0",max:b&&i.current?Math.max(0,i.current.duration-h):0,step:"0.1",value:u.toFixed(1),onChange:e=>E(parseFloat(e.target.value)),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white text-sm focus:border-green-400 focus:outline-none"})]}),ne.jsxs("div",{children:[ne.jsx("label",{className:"block text-sm font-medium text-slate-400 mb-1",children:"Zone Duration (fixed)"}),ne.jsx("input",{type:"number",value:h.toFixed(1),disabled:!0,className:"w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded-lg text-slate-300 text-sm cursor-not-allowed"}),ne.jsx("div",{className:"text-xs text-slate-500 mt-1",children:"Duration matches plan length"})]})]})]})]}),ne.jsx("div",{className:"p-6 border-t border-slate-700 bg-slate-800/50",children:ne.jsxs("div",{className:"flex items-center justify-between",children:[ne.jsxs("button",{onClick:F,className:"flex items-center space-x-2 px-4 py-2 bg-slate-700 hover:bg-slate-600 rounded-lg transition-colors text-white",children:[ne.jsx(k,{className:"w-4 h-4"}),ne.jsx("span",{children:"Reset"})]}),ne.jsxs("div",{className:"flex items-center space-x-3",children:[ne.jsx("button",{onClick:n,className:"px-6 py-2 border border-slate-600 rounded-lg text-slate-300 hover:text-white hover:border-slate-500 transition-colors",children:"Cancel"}),ne.jsxs("button",{onClick:P,className:"flex items-center space-x-2 px-6 py-2 bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 rounded-lg text-white font-medium transition-all",children:[ne.jsx(C,{className:"w-4 h-4"}),ne.jsx("span",{children:"Apply Trim"})]})]})]})})]})})},me=({video:e,planIndex:t,trimSettings:s})=>{const a=x.useRef(null),[r,n]=x.useState(!1);return x.useEffect(()=>{const e=a.current;if(!e||!s)return;const t=()=>{n(!0),e.currentTime=s.startTime},r=()=>{e.currentTime>=s.endTime&&(e.currentTime=s.startTime)};return e.addEventListener("loadedmetadata",t),e.addEventListener("timeupdate",r),()=>{e.removeEventListener("loadedmetadata",t),e.removeEventListener("timeupdate",r)}},[s]),ne.jsx("video",{ref:a,src:e.videoUrl,autoPlay:!0,loop:!s,muted:!0,playsInline:!0,className:"absolute inset-0 w-full h-full object-cover",onError:t=>{var s;const a=t.target;a.style.display="none";const r=document.createElement("img");r.src=e.thumbnail,r.className="absolute inset-0 w-full h-full object-cover",r.alt=e.title,null==(s=a.parentNode)||s.appendChild(r)}})},he=({cutMarkers:e,currentTime:t,currentTheme:s,startTime:a,endTime:r,videoAssignments:n,onVideoAssignmentsChange:i,audioDuration:l,onVideoTrimChange:o,videoTrimSettings:d=new Map})=>{const[c,m]=x.useState(new Map),[h,u]=x.useState({isOpen:!1,video:null,planIndex:0}),[p,g]=x.useState(new Set);x.useRef(null),x.useEffect(()=>{n&&m(new Map(n))},[n]);const{currentCut:f,currentColor:b,currentPlan:v,currentVideo:j}=x.useMemo(()=>{if(0===e.length){return{currentCut:null,currentColor:"#3B82F6",currentPlan:1,currentVideo:c.get(1)||null}}const s=[...e].sort((e,t)=>e.time-t.time);for(let e=0;e<s.length;e++){const a=s[e],r=s[e+1];if(t>=a.time&&(!r||t<r.time)){const t=e+2,s=c.get(t);return{currentCut:a,currentColor:a.color,currentPlan:t,currentVideo:s||null}}}return{currentCut:null,currentColor:"#3B82F6",currentPlan:1,currentVideo:c.get(1)||null}},[e,t,c]),w=e=>`${Math.floor(e/60)}:${Math.floor(e%60).toString().padStart(2,"0")}`,y=(e,t)=>{u({isOpen:!0,video:e,planIndex:t})},N=t=>{var s,n,i;const l=[...e].sort((e,t)=>e.time-t.time);if(1===t){return((null==(s=l[0])?void 0:s.time)||r)-a}{const e=(null==(n=l[t-2])?void 0:n.time)||a;return((null==(i=l[t-1])?void 0:i.time)||r)-e}},T=()=>{const s=e.sort((e,t)=>e.time-t.time);for(let e=0;e<s.length;e++){const a=s[e],r=s[e+1];if(t>=a.time&&(!r||t<r.time))return e+2}return 1},S=(e,t)=>!!e&&e.duration<t;return x.useMemo(()=>e.filter(e=>e.time>t).sort((e,t)=>e.time-t.time).slice(0,3),[e,t]),ne.jsxs("div",{className:"space-y-6",children:[ne.jsxs("div",{className:"flex flex-col items-center",children:[ne.jsx("div",{className:"text-sm text-slate-400 mb-3 font-medium",children:"📱 Preview Mobile"}),ne.jsx("div",{className:"relative",children:ne.jsx("div",{className:"w-44 h-78 bg-black rounded-3xl p-2 shadow-2xl border-4 border-slate-700",style:{aspectRatio:"9/19.5"},children:ne.jsxs("div",{className:"w-full h-full rounded-2xl overflow-hidden relative",style:{aspectRatio:"9/16"},children:[j?ne.jsxs(ne.Fragment,{children:[ne.jsx(me,{video:j,planIndex:v,trimSettings:d.get(v)}),ne.jsx("div",{className:"absolute inset-0 bg-black/30"})]}):ne.jsx("div",{className:"absolute inset-0",style:{backgroundColor:b}}),ne.jsx("div",{className:"absolute inset-0 flex items-center justify-center z-10",children:ne.jsxs("div",{className:"text-white text-2xl font-bold bg-black/50 px-4 py-2 rounded-lg",children:["Plan ",T()]})})]})})})]}),ne.jsxs("div",{children:[ne.jsx("div",{className:"flex items-center justify-between mb-4",children:ne.jsxs("h4",{className:"text-sm font-medium text-slate-300 flex items-center space-x-2",children:[ne.jsx("div",{className:"w-4 h-4 bg-gradient-to-r from-blue-500 to-purple-500 rounded"}),ne.jsx("span",{children:"Timeline"})]})}),ne.jsxs("div",{className:"space-y-2 max-h-72 overflow-y-auto custom-scrollbar",children:[(()=>{var s,n;const i=e.sort((e,t)=>e.time-t.time),l=N(1),o=c.get(1),d=1===T(),m=t>((null==(s=i[0])?void 0:s.time)||r);return ne.jsx("div",{className:"p-4 rounded-xl border transition-all duration-200 "+(d?"border-green-400 bg-green-400/20 shadow-lg shadow-green-400/25":m?"border-slate-600 bg-slate-700/30 opacity-60":"border-slate-600 bg-slate-700/50 hover:bg-slate-700/70"),children:ne.jsxs("div",{className:"flex items-center justify-between",children:[ne.jsxs("div",{className:"flex items-center space-x-3",children:[ne.jsx("div",{className:"w-6 h-6 bg-blue-500 rounded-full border-2 border-white flex items-center justify-center text-xs font-bold shadow-lg",children:"1"}),ne.jsxs("div",{className:"flex-1",children:[ne.jsx("div",{className:"text-white font-semibold",children:"Plan 1"}),ne.jsxs("div",{className:"text-xs text-slate-400 font-mono",children:[w(a)," → ",w((null==(n=i[0])?void 0:n.time)||r),l>0&&` • ${Math.round(l)}s duration`]}),o&&ne.jsxs("div",{className:"text-xs text-blue-300 mt-1 truncate max-w-[200px]",children:["📹 ",o.title,p.has(1)&&ne.jsx("span",{className:"ml-2 text-xs text-green-400 font-semibold",children:"✂️ Trimmed"}),S(o,l)&&ne.jsx("span",{className:"ml-2 text-xs text-yellow-400 font-semibold",title:`Video duration: ${o.duration.toFixed(1)}s < Plan duration: ${l.toFixed(1)}s`,children:"⚠️ Too short"})]})]})]}),ne.jsxs("div",{className:"flex items-center space-x-2",children:[o&&ne.jsx("button",{onClick:()=>y(o,1),className:"p-2 bg-blue-600/20 hover:bg-blue-600/30 border border-blue-500/30 rounded-lg transition-colors group",title:"Trim video for Plan 1",children:ne.jsx(C,{className:"w-4 h-4 text-blue-400 group-hover:text-blue-300"})}),d&&ne.jsx("div",{className:"text-green-400 text-xs font-bold animate-pulse bg-green-400/20 px-2 py-1 rounded-full",children:"ACTIVE"})]})]})})})(),e.sort((e,t)=>e.time-t.time).map((e,s)=>{const a=T(),r=s+2,n=a===r,i=t>e.time&&!n,l=N(r),o=c.get(r);return ne.jsx("div",{className:"p-4 rounded-xl border transition-all duration-200 "+(n?"border-green-400 bg-green-400/20 shadow-lg shadow-green-400/25":i?"border-slate-600 bg-slate-700/30 opacity-60":"border-slate-600 bg-slate-700/50 hover:bg-slate-700/70"),children:ne.jsxs("div",{className:"flex items-center justify-between",children:[ne.jsxs("div",{className:"flex items-center space-x-3",children:[ne.jsx("div",{className:"w-6 h-6 rounded-full border-2 border-white flex items-center justify-center text-xs font-bold shadow-lg",style:{backgroundColor:e.color},children:s+1}),ne.jsxs("div",{className:"flex-1",children:[ne.jsxs("div",{className:"text-white font-semibold",children:["Plan ",r]}),ne.jsxs("div",{className:"text-xs text-slate-400 font-mono",children:[w(e.time),l>0&&` • ${Math.round(l)}s duration`]}),o&&ne.jsxs("div",{className:"text-xs text-blue-300 mt-1 truncate max-w-[200px]",children:["📹 ",o.title,p.has(r)&&ne.jsx("span",{className:"ml-2 text-xs text-green-400 font-semibold",children:"✂️ Trimmed"}),S(o,l)&&ne.jsx("span",{className:"ml-2 text-xs text-yellow-400 font-semibold",title:`Video duration: ${o.duration.toFixed(1)}s < Plan duration: ${l.toFixed(1)}s`,children:"⚠️ Too short"})]})]})]}),ne.jsxs("div",{className:"flex items-center space-x-2",children:[o&&ne.jsx("button",{onClick:()=>y(o,r),className:"p-2 bg-blue-600/20 hover:bg-blue-600/30 border border-blue-500/30 rounded-lg transition-colors group",title:`Trim video for Plan ${r}`,children:ne.jsx(C,{className:"w-4 h-4 text-blue-400 group-hover:text-blue-300"})}),n&&ne.jsx("div",{className:"text-green-400 text-xs font-bold animate-pulse bg-green-400/20 px-2 py-1 rounded-full",children:"ACTIVE"})]})]})},e.id)})]})]}),ne.jsxs("div",{className:"bg-slate-700/30 rounded-xl p-4 border border-slate-600/30",children:[ne.jsx("div",{className:"text-sm text-slate-400 mb-3 font-medium",children:"📊 Template Stats"}),ne.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[ne.jsxs("div",{children:[ne.jsx("div",{className:"text-white font-bold text-lg",children:e.length+1}),ne.jsx("div",{className:"text-slate-400",children:"Total Plans"})]}),ne.jsxs("div",{children:[ne.jsx("div",{className:"text-white font-bold text-lg",children:c.size}),ne.jsx("div",{className:"text-slate-400",children:"Videos Assigned"})]})]})]}),h.isOpen&&h.video&&ne.jsx(ce,{video:h.video,planIndex:h.planIndex,audioDuration:l,planDuration:(t=>{var s;const n=[...e].sort((e,t)=>e.time-t.time);if(1===t){const e=(null==(s=n[0])?void 0:s.time)||r;return Math.max(.1,e-a)}{const e=t-2,s=n[e],a=n[e+1];if(s){const e=a?a.time:r;return Math.max(.1,e-s.time)}}return 1})(h.planIndex),onTrimChange:(e,t,s)=>{null==o||o(e,t,s),g(t=>new Set(t).add(e));const a=s-t,r=document.createElement("div");r.style.cssText="\n      position: fixed;\n      top: 20px;\n      right: 20px;\n      background: linear-gradient(135deg, #10B981, #059669);\n      color: white;\n      padding: 12px 20px;\n      border-radius: 8px;\n      box-shadow: 0 4px 12px rgba(0,0,0,0.3);\n      z-index: 9999;\n      font-family: system-ui, -apple-system, sans-serif;\n      font-size: 14px;\n      font-weight: 500;\n      opacity: 0;\n      transform: translateX(100%);\n      transition: all 0.3s ease;\n    ",r.innerHTML=`✅ Plan ${e} trimmed: ${a.toFixed(1)}s`,document.body.appendChild(r),setTimeout(()=>{r.style.opacity="1",r.style.transform="translateX(0)"},10),setTimeout(()=>{r.style.opacity="0",r.style.transform="translateX(100%)",setTimeout(()=>document.body.removeChild(r),300)},3e3)},onClose:()=>{u({isOpen:!1,video:null,planIndex:0})}})]})};async function ue(e,t){const{startTime:s,endTime:a}=t,r=new AudioContext;try{const t=await e.arrayBuffer(),n=await r.decodeAudioData(t),i=n.sampleRate,l=Math.floor(s*i),o=Math.floor(a*i),d=o-l;if(l>=o||l<0||o>n.length)throw new Error("Invalid trim parameters");const c=r.createBuffer(n.numberOfChannels,d,i);for(let e=0;e<n.numberOfChannels;e++){const t=n.getChannelData(e),s=c.getChannelData(e);for(let e=0;e<d;e++)s[e]=t[l+e]}const m=await async function(e){const t=e.numberOfChannels,s=e.sampleRate,a=1,r=16,n=t*(r/8),i=s*n,l=e.length*n,o=44+l,d=new ArrayBuffer(o),c=new DataView(d),m=(e,t)=>{for(let s=0;s<t.length;s++)c.setUint8(e+s,t.charCodeAt(s))};m(0,"RIFF"),c.setUint32(4,o-8,!0),m(8,"WAVE"),m(12,"fmt "),c.setUint32(16,16,!0),c.setUint16(20,a,!0),c.setUint16(22,t,!0),c.setUint32(24,s,!0),c.setUint32(28,i,!0),c.setUint16(32,n,!0),c.setUint16(34,r,!0),m(36,"data"),c.setUint32(40,l,!0);let h=44;for(let u=0;u<e.length;u++)for(let s=0;s<t;s++){const t=Math.max(-1,Math.min(1,e.getChannelData(s)[u])),a=t<0?32768*t:32767*t;c.setInt16(h,a,!0),h+=2}return new Blob([d],{type:"audio/wav"})}(c);return m}finally{await r.close()}}class xe{static generateBasePrefix(e){const{category:t,templateNumber:s,musicId:a}=e.projectSettings,{planCount:r,duration:n}=e;return`${t}_${s}_${a}_${r}_${Math.ceil(n)}s`}static generateProjectFilename(e){return`${this.generateBasePrefix(e)}_project.json`}static generateMusicFilename(e,t,s,a){const r=this.generateBasePrefix(e);if(void 0!==t&&void 0!==s){return`${r}_music_trimmed_${Math.floor(t)}s-${Math.floor(s)}s_${Math.ceil(s-t)}s.wav`}return`${r}_music.wav`}static generateFinalVideoFilename(e,t){return`${this.generateBasePrefix(e)}_render_${"high"===t?"HD":"SD"}.mp4`}static generateThumbnailFilename(e,t,s,a,r="jpeg"){return`${this.generateBasePrefix(e)}_thumbnail_${t}_${s}x${a}.${r}`}static generateRawVideoFilename(e,t,s){return`${this.generateBasePrefix(e)}_video${t}.mp4`}static generateVideoExportFilename(e,t){return`${this.generateBasePrefix(e)}_video${t+1}.mp4`}static extractSettingsFromDOM(){try{document.querySelector('input[placeholder="Category"], input[value*="Travel"], input[type="text"]'),document.querySelector('input[placeholder="Template #"], input[value*="006"]'),document.querySelector('input[placeholder="Music ID"], input[value*="012"]');let e="Travel",t="006",s="012";return document.querySelectorAll('input[type="text"]').forEach(a=>{var r,n,i;const l=a,o=(null==(n=null==(r=l.parentElement)?void 0:r.textContent)?void 0:n.toLowerCase())||"",d=(null==(i=l.placeholder)?void 0:i.toLowerCase())||"";o.includes("category")||d.includes("category")?e=l.value||"Travel":o.includes("template")||d.includes("template")?t=l.value||"006":(o.includes("music")||d.includes("music"))&&(s=l.value||"012")}),{category:e,templateNumber:t,musicId:s}}catch(e){return{category:"Travel",templateNumber:"006",musicId:"012"}}}static createContext(e,t,s){return{projectSettings:e,duration:s,planCount:t.length+1}}}const pe=({audioFile:e,cutMarkers:t,startTime:s,endTime:a,videoAssignments:r=new Map})=>{const[n,i]=x.useState(!1),[l,o]=x.useState({category:"Travel",templateNumber:"006",musicId:"012"}),d=e=>{const r=xe.createContext(l,t,a-s);return"music"===e?xe.generateMusicFilename(r).replace(".wav",""):xe.generateProjectFilename(r).replace(".json","")},c=e=>`${Math.floor(e/60)}:${Math.floor(e%60).toString().padStart(2,"0")}`;return ne.jsxs("div",{className:"space-y-4",children:[ne.jsxs("div",{children:[ne.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[ne.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-orange-500 to-red-500 rounded-xl flex items-center justify-center shadow-lg",children:ne.jsx(A,{className:"w-5 h-5 text-white"})}),ne.jsxs("div",{children:[ne.jsx("h3",{className:"text-lg font-semibold text-white",children:"Export Settings"}),ne.jsx("p",{className:"text-xs text-slate-400",children:"Configure your project export"})]})]}),ne.jsxs("div",{className:"space-y-4",children:[ne.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[ne.jsxs("div",{children:[ne.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Category"}),ne.jsx("input",{type:"text",value:l.category,onChange:e=>o(t=>({...t,category:e.target.value})),className:"w-full px-3 py-2 bg-slate-700/50 border border-slate-600 rounded-lg text-white text-sm focus:border-blue-400 focus:outline-none transition-colors",placeholder:"Travel"})]}),ne.jsxs("div",{children:[ne.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Template #"}),ne.jsx("input",{type:"text",value:l.templateNumber,onChange:e=>o(t=>({...t,templateNumber:e.target.value})),className:"w-full px-3 py-2 bg-slate-700/50 border border-slate-600 rounded-lg text-white text-sm focus:border-blue-400 focus:outline-none transition-colors",placeholder:"006"})]}),ne.jsxs("div",{children:[ne.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Music ID"}),ne.jsx("input",{type:"text",value:l.musicId,onChange:e=>o(t=>({...t,musicId:e.target.value})),className:"w-full px-3 py-2 bg-slate-700/50 border border-slate-600 rounded-lg text-white text-sm focus:border-blue-400 focus:outline-none transition-colors",placeholder:"012"})]})]}),ne.jsxs("div",{className:"bg-gradient-to-br from-slate-800/50 to-slate-900/50 rounded-2xl p-5 border border-slate-600/40 backdrop-blur-sm",children:[ne.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[ne.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-purple-500 to-pink-500 rounded-lg flex items-center justify-center",children:ne.jsx(L,{className:"w-4 h-4 text-white"})}),ne.jsx("span",{className:"text-sm text-slate-300 font-medium",children:"Preview Filenames"})]}),ne.jsxs("div",{className:"space-y-3",children:[ne.jsxs("div",{className:"flex items-center gap-3 p-3 bg-blue-500/10 border border-blue-500/20 rounded-lg",children:[ne.jsx("div",{className:"w-6 h-6 bg-blue-500 rounded flex items-center justify-center",children:ne.jsx(L,{className:"w-3 h-3 text-white"})}),ne.jsxs("span",{className:"text-xs font-mono text-blue-200 truncate",children:[d("project"),".json"]})]}),ne.jsxs("div",{className:"flex items-center gap-3 p-3 bg-orange-500/10 border border-orange-500/20 rounded-lg",children:[ne.jsx("div",{className:"w-6 h-6 bg-orange-500 rounded flex items-center justify-center",children:ne.jsx(b,{className:"w-3 h-3 text-white"})}),ne.jsxs("span",{className:"text-xs font-mono text-orange-200 truncate",children:[d("music"),".wav"]})]})]})]}),ne.jsxs("div",{className:"bg-gradient-to-br from-slate-800/50 to-slate-900/50 rounded-2xl p-5 border border-slate-600/40 backdrop-blur-sm",children:[ne.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[ne.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-green-500 to-teal-500 rounded-lg flex items-center justify-center",children:ne.jsx(C,{className:"w-4 h-4 text-white"})}),ne.jsx("span",{className:"text-sm text-slate-300 font-medium",children:"Trim Settings"})]}),ne.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[ne.jsxs("div",{className:"p-3 bg-green-500/10 border border-green-500/20 rounded-lg",children:[ne.jsx("div",{className:"text-green-300 text-xs font-medium mb-1",children:"IN Point"}),ne.jsx("div",{className:"text-white font-mono text-lg",children:c(s)})]}),ne.jsxs("div",{className:"p-3 bg-red-500/10 border border-red-500/20 rounded-lg",children:[ne.jsx("div",{className:"text-red-300 text-xs font-medium mb-1",children:"OUT Point"}),ne.jsx("div",{className:"text-white font-mono text-lg",children:c(a)})]})]}),s>=a&&ne.jsxs("div",{className:"mt-4 text-amber-200 text-xs bg-amber-500/10 rounded-lg p-3 border border-amber-500/20 flex items-center gap-2",children:[ne.jsx("div",{className:"w-5 h-5 bg-amber-500 rounded-full flex items-center justify-center",children:ne.jsx("span",{className:"text-white text-xs",children:"!"})}),ne.jsx("span",{children:"Invalid trim points: OUT must be after IN"})]})]}),ne.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[ne.jsxs("div",{className:"group relative overflow-hidden rounded-2xl bg-gradient-to-br from-blue-500/20 via-blue-600/10 to-purple-600/20 border border-blue-500/30 hover:border-blue-400/50 transition-all duration-300 hover:scale-105 hover:shadow-lg hover:shadow-blue-500/25",children:[ne.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-400/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),ne.jsxs("div",{className:"relative p-5 text-center",children:[ne.jsx("div",{className:"flex items-center justify-center mb-3",children:ne.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-r from-blue-500 to-blue-600 flex items-center justify-center shadow-lg",children:ne.jsx(j,{className:"w-5 h-5 text-white"})})}),ne.jsx("div",{className:"text-blue-200 text-sm font-medium mb-1",children:"Duration"}),ne.jsxs("div",{className:"text-white font-bold text-2xl tracking-wide",children:[Math.ceil(a-s),ne.jsx("span",{className:"text-blue-300 text-lg ml-1",children:"s"})]})]})]}),ne.jsxs("div",{className:"group relative overflow-hidden rounded-2xl bg-gradient-to-br from-emerald-500/20 via-emerald-600/10 to-teal-600/20 border border-emerald-500/30 hover:border-emerald-400/50 transition-all duration-300 hover:scale-105 hover:shadow-lg hover:shadow-emerald-500/25",children:[ne.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-emerald-400/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),ne.jsxs("div",{className:"relative p-5 text-center",children:[ne.jsx("div",{className:"flex items-center justify-center mb-3",children:ne.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-r from-emerald-500 to-emerald-600 flex items-center justify-center shadow-lg",children:ne.jsx(P,{className:"w-5 h-5 text-white"})})}),ne.jsx("div",{className:"text-emerald-200 text-sm font-medium mb-1",children:"Plans"}),ne.jsx("div",{className:"text-white font-bold text-2xl tracking-wide",children:t.length+1})]})]})]})]})]}),ne.jsxs("div",{className:"space-y-3",children:[ne.jsxs("button",{onClick:async()=>{i(!0);try{const e=(()=>{const e=Date.now()/1e3,n=a-s,i=xe.createContext(l,t,a-s),o=xe.generateMusicFilename(i,s,a),c=(()=>{const e=[],n=[...t].sort((e,t)=>e.time-t.time),i=n.length>0?n[0].time:a;e.push({planIndex:1,video:(null==r?void 0:r.get(1))||null,startTime:s,endTime:Math.min(i,a)});for(let t=0;t<n.length;t++){const i=n[t],l=n[t+1],o=t+2;i.time<a&&e.push({planIndex:o,video:(null==r?void 0:r.get(o))||null,startTime:Math.max(i.time,s),endTime:Math.min(l?l.time:a,a)})}return e.filter(e=>e.endTime>e.startTime)})().map((e,t)=>{const s=e.endTime-e.startTime,a=[[.75,.75,.75,1],[.33333334,0,0,1],[1,.932,.32,1],[0,.5,1,1],[.5,1,0,1],[1,0,1,1],[1,.5,0,1],[.5,0,1,1]];return{scale:[1,1.777,1],backgroundBlurEnabled:!1,animationStartScale:[1,1.777,1],blend:{none:{}},colorAdjustment:{sharpness:0,exposure:0,temperature:0,contrast:1,saturation:1,hue:0},contentRotation:0,aspect:{aspectFill:{}},animationStartRotation:[0,0,0],backgroundColor:[0,0,0,1],isAnimated:!1,animationEndScale:[1,1.777,1],position:[0,0],animationEndPosition:[0,0],kind:{empty:{}},animationEndRotation:[0,0,0],color:a[t%a.length],animationStartPosition:[0,0],opacity:1,name:`Plan ${e.planIndex}`,rotation:[0,0,0],duration:s}});return{id:crypto.randomUUID().toUpperCase(),title:d("project"),lastModificationDate:e,editionProject:{mainTimeline:c,aspectRatio:{r_9_16:{}},superpositionTimeline:[],audioTimeline:[{duration:n,startTime:0,fileName:o,gain:1,playbackSpeed:1,fileTrimStart:s,isMuted:!1}]}}})(),n=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),i=xe.createContext(l,t,a-s),o=xe.generateProjectFilename(i),c=URL.createObjectURL(n),m=document.createElement("a");m.href=c,m.download=o,document.body.appendChild(m),m.click(),document.body.removeChild(m),URL.revokeObjectURL(c)}catch(e){alert("Export failed. Please try again.")}finally{i(!1)}},disabled:n||0===t.length,className:"w-full flex items-center justify-center space-x-3 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 disabled:from-slate-600 disabled:to-slate-600 disabled:cursor-not-allowed px-6 py-4 rounded-xl transition-all duration-200 shadow-lg hover:shadow-xl transform hover:scale-105 disabled:transform-none font-semibold",children:[n?ne.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}):ne.jsx(L,{className:"w-5 h-5"}),ne.jsx("span",{children:"Export Snapcut Project"})]}),ne.jsxs("button",{onClick:async()=>{i(!0);try{const r=await ue(e.file,{startTime:s,endTime:a,originalFileName:e.name}),n=xe.createContext(l,t,a-s);!function(e,t){const s=URL.createObjectURL(e),a=document.createElement("a");a.href=s,a.download=t,a.style.display="none",document.body.appendChild(a),a.click(),document.body.removeChild(a),setTimeout(()=>{URL.revokeObjectURL(s)},1e3)}(r,xe.generateMusicFilename(n,s,a))}catch(r){const e=r instanceof Error?r.message:"Unknown error";alert(`Audio export failed: ${e}\n\nPlease check that your IN/OUT points are valid and try again.`)}finally{i(!1)}},disabled:n||s>=a,className:"w-full flex items-center justify-center space-x-3 bg-gradient-to-r from-orange-500 to-orange-600 hover:from-orange-600 hover:to-orange-700 disabled:from-slate-600 disabled:to-slate-600 disabled:cursor-not-allowed px-6 py-4 rounded-xl transition-all duration-200 shadow-lg hover:shadow-xl transform hover:scale-105 disabled:transform-none font-semibold",children:[n?ne.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}):ne.jsx(C,{className:"w-5 h-5"}),ne.jsx("span",{children:"Export Trimmed Audio"})]})]}),0===t.length&&ne.jsxs("div",{className:"text-center py-6 text-slate-400 text-sm bg-slate-700/20 rounded-xl border border-slate-600/30",children:[ne.jsx("div",{className:"text-2xl mb-2",children:"✂️"}),ne.jsx("p",{className:"font-medium",children:"Add some cuts to enable JSON export"})]}),s>=a&&ne.jsxs("div",{className:"text-center py-6 text-amber-400 text-sm bg-amber-500/10 rounded-xl border border-amber-500/20",children:[ne.jsx("div",{className:"text-2xl mb-2",children:"⚠️"}),ne.jsx("p",{className:"font-medium",children:"Set valid IN/OUT points to enable audio export"}),ne.jsx("p",{className:"text-xs mt-2 opacity-75",children:"Use I and O keys or Set IN/OUT buttons"})]})]})},ge=({isOpen:e,onClose:t,onGenerate:s,hasInOutPoints:a,startTime:r,endTime:n,duration:i,existingCutsCount:l})=>{const[o,d]=x.useState(4),[c,m]=x.useState(!0);if(!e)return null;const h=e=>`${Math.floor(e/60)}:${Math.floor(e%60).toString().padStart(2,"0")}`,u=n-r,p=Math.floor(u/2);return ne.jsxs("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:[ne.jsxs("div",{className:"bg-slate-800 rounded-2xl border border-slate-700/50 shadow-2xl max-w-md w-full",children:[ne.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-slate-700/50",children:[ne.jsxs("div",{className:"flex items-center space-x-3",children:[ne.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-purple-500 to-pink-500 rounded-xl flex items-center justify-center shadow-lg",children:ne.jsx(S,{className:"w-5 h-5 text-white"})}),ne.jsxs("div",{children:[ne.jsx("h2",{className:"text-xl font-bold text-white",children:"Random Mode"}),ne.jsx("p",{className:"text-sm text-slate-400",children:"Generate beat-synced cuts automatically"})]})]}),ne.jsx("button",{onClick:t,className:"w-8 h-8 bg-slate-700 hover:bg-slate-600 rounded-lg flex items-center justify-center transition-colors",children:ne.jsx(F,{className:"w-4 h-4 text-slate-400"})})]}),ne.jsxs("div",{className:"p-6 space-y-6",children:[!a&&ne.jsx("div",{className:"bg-amber-500/10 border border-amber-500/30 rounded-xl p-4",children:ne.jsxs("div",{className:"flex items-start space-x-3",children:[ne.jsx(_,{className:"w-5 h-5 text-amber-400 flex-shrink-0 mt-0.5"}),ne.jsxs("div",{children:[ne.jsx("h3",{className:"text-amber-400 font-semibold",children:"Setup Required"}),ne.jsx("p",{className:"text-sm text-amber-300/90 mt-1",children:"Please set IN and OUT points first to define the active region for random cuts."}),ne.jsxs("div",{className:"flex items-center space-x-4 mt-3 text-xs text-amber-300/70",children:[ne.jsxs("span",{children:["Press ",ne.jsx("kbd",{className:"bg-amber-500/20 px-1 py-0.5 rounded",children:"I"})," to set IN point"]}),ne.jsxs("span",{children:["Press ",ne.jsx("kbd",{className:"bg-amber-500/20 px-1 py-0.5 rounded",children:"O"})," to set OUT point"]})]})]})]})}),ne.jsxs("div",{className:"bg-slate-700/30 rounded-xl p-4 border border-slate-600/30",children:[ne.jsxs("h3",{className:"text-white font-semibold mb-3 flex items-center space-x-2",children:[ne.jsx(O,{className:"w-4 h-4 text-blue-400"}),ne.jsx("span",{children:"Current Settings"})]}),ne.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[ne.jsxs("div",{children:[ne.jsx("div",{className:"text-slate-400",children:"Active Region"}),ne.jsxs("div",{className:"text-white font-mono",children:[h(r)," → ",h(n)]}),ne.jsxs("div",{className:"text-slate-400 text-xs",children:[Math.round(u),"s duration"]})]}),ne.jsxs("div",{children:[ne.jsx("div",{className:"text-slate-400",children:"Existing Cuts"}),ne.jsx("div",{className:"text-white font-bold text-lg",children:l}),l>0&&ne.jsx("div",{className:"text-slate-400 text-xs",children:c?"Will be replaced":"Will be kept"})]})]})]}),ne.jsx("div",{className:"space-y-4",children:ne.jsxs("label",{className:"block",children:[ne.jsx("span",{className:"text-white font-semibold mb-2 block",children:"Number of Plans"}),ne.jsxs("div",{className:"relative",children:[ne.jsx("input",{type:"range",min:"2",max:Math.max(8,p),value:o,onChange:e=>d(parseInt(e.target.value)),className:"w-full h-2 bg-slate-700 rounded-lg appearance-none cursor-pointer slider",disabled:!a}),ne.jsxs("div",{className:"flex justify-between text-xs text-slate-400 mt-2",children:[ne.jsx("span",{children:"2"}),ne.jsxs("span",{className:"text-white font-bold",children:[o," plans (",o-1," cuts)"]}),ne.jsx("span",{children:Math.max(8,p)})]})]}),o>p&&ne.jsx("p",{className:"text-amber-400 text-xs mt-2",children:"⚠️ Many cuts for this duration - might feel too fast"})]})}),l>0&&ne.jsxs("div",{className:"space-y-3",children:[ne.jsx("h3",{className:"text-white font-semibold",children:"Options"}),ne.jsxs("label",{className:"flex items-center space-x-3",children:[ne.jsx("input",{type:"checkbox",checked:c,onChange:e=>m(e.target.checked),className:"w-4 h-4 text-purple-500 bg-slate-700 border-slate-600 rounded focus:ring-purple-500",disabled:!a}),ne.jsx("span",{className:"text-slate-300",children:"Replace existing cuts"})]})]}),ne.jsxs("div",{className:"flex space-x-3 pt-4",children:[ne.jsx("button",{onClick:t,className:"flex-1 px-4 py-3 bg-slate-700 hover:bg-slate-600 text-white rounded-xl transition-colors font-medium",children:"Cancel"}),ne.jsxs("button",{onClick:()=>{s(o),t()},disabled:!a,className:"flex-1 px-4 py-3 bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 disabled:from-slate-600 disabled:to-slate-600 text-white rounded-xl transition-all duration-200 font-medium shadow-lg disabled:shadow-none flex items-center justify-center space-x-2",children:[ne.jsx(S,{className:"w-4 h-4"}),ne.jsx("span",{children:"Generate Cuts"})]})]})]})]}),ne.jsx("style",{dangerouslySetInnerHTML:{__html:"\n          .slider::-webkit-slider-thumb {\n            appearance: none;\n            height: 20px;\n            width: 20px;\n            border-radius: 50%;\n            background: linear-gradient(45deg, #9333ea, #ec4899);\n            cursor: pointer;\n            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);\n          }\n          \n          .slider::-moz-range-thumb {\n            height: 20px;\n            width: 20px;\n            border-radius: 50%;\n            background: linear-gradient(45deg, #9333ea, #ec4899);\n            cursor: pointer;\n            border: none;\n            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);\n          }\n        "}})]})},fe={},be=function(e,t,s){let a=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const e=document.querySelector("meta[property=csp-nonce]"),s=(null==e?void 0:e.nonce)||(null==e?void 0:e.getAttribute("nonce"));a=Promise.allSettled(t.map(e=>{if((e=function(e){return"/"+e}(e))in fe)return;fe[e]=!0;const t=e.endsWith(".css"),a=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${a}`))return;const r=document.createElement("link");return r.rel=t?"stylesheet":"modulepreload",t||(r.as="script"),r.crossOrigin="",r.href=e,s&&r.setAttribute("nonce",s),document.head.appendChild(r),t?new Promise((t,s)=>{r.addEventListener("load",t),r.addEventListener("error",()=>s(new Error(`Unable to preload CSS for ${e}`)))}):void 0}))}function r(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return a.then(t=>{for(const e of t||[])"rejected"===e.status&&r(e.reason);return e().catch(r)})};class ve extends Error{constructor(e,t,s){super(e),this.code=t,this.originalError=s,this.name="VideoServiceError"}}const je="https://api.pexels.com/videos",we="RlTeMfZKQW3nbCkAxYhNDRuzkX7v7MVrR0S0XsgM4EGOZd82iDU5PLYH",ye=200;const Ne=new class{constructor(){this.requestCount=0,this.lastResetTime=Date.now()}getHeaders(){return{Authorization:we,"Content-Type":"application/json"}}canMakeRequest(){const e=Date.now();return(e-this.lastResetTime)/36e5>=1&&(this.requestCount=0,this.lastResetTime=e),this.requestCount<ye}transformPexelsVideo(e,t){var s;const a=e.video_files.filter(e=>"video/mp4"===e.file_type).sort((e,t)=>"hd"===e.quality&&"hd"!==t.quality?-1:"hd"===t.quality&&"hd"!==e.quality?1:t.width*t.height-e.width*e.height)[0],r=(null==(s=e.video_pictures[0])?void 0:s.picture)||e.image;return{id:e.id.toString(),title:e.tags.slice(0,3).join(" ")||"Video",thumbnail:r,videoUrl:(null==a?void 0:a.link)||"",duration:e.duration,width:e.width,height:e.height,theme:t,tags:e.tags,avgColor:e.avg_color,author:{name:e.user.name,url:e.user.url}}}async searchVideosByTheme(e,t){if(!this.canMakeRequest())throw new ve("API quota exceeded. Please try again later.","QUOTA_EXCEEDED");try{let s=this.getThemeKeywords(e.theme);t&&t.length>0&&(s=[...t,...s.slice(0,2)]);const a=s.join(" "),r=new URL(`${je}/search`);r.searchParams.set("query",a),r.searchParams.set("per_page",(e.perPage||15).toString()),r.searchParams.set("page",(e.page||1).toString()),e.orientation&&r.searchParams.set("orientation",e.orientation),e.size&&r.searchParams.set("size",e.size);const n=await fetch(r.toString(),{headers:this.getHeaders()});if(this.requestCount++,!n.ok){if(429===n.status)throw new ve("Too many requests. Please wait before trying again.","QUOTA_EXCEEDED");throw new ve(`API request failed: ${n.status}`,"API_ERROR")}const i=(await n.json()).videos.filter(t=>!(e.minDuration&&t.duration<e.minDuration)&&!(e.maxDuration&&t.duration>e.maxDuration)).map(t=>this.transformPexelsVideo(t,e.theme)).filter(e=>e.videoUrl);t&&t.length>0&&t.join(", ");return i}catch(s){if(s instanceof ve)throw s;throw new ve("Failed to fetch videos from Pexels","NETWORK_ERROR",s)}}async getPopularVideos(e,t=20){if(!this.canMakeRequest())throw new ve("API quota exceeded. Please try again later.","QUOTA_EXCEEDED");try{const s=new URL(`${je}/popular`);s.searchParams.set("per_page",t.toString());const a=await fetch(s.toString(),{headers:this.getHeaders()});if(this.requestCount++,!a.ok)throw new ve(`Failed to fetch popular videos: ${a.status}`,"API_ERROR");const r=await a.json(),n=this.getThemeKeywords(e);return r.videos.filter(e=>{const t=e.tags.map(e=>e.toLowerCase());return n.some(e=>t.some(t=>t.includes(e.toLowerCase())))}).slice(0,t).map(t=>this.transformPexelsVideo(t,e)).filter(e=>e.videoUrl)}catch(s){if(s instanceof ve)throw s;return this.getMockVideos(e,t)}}getThemeKeywords(e){return{Travel:["travel","vacation","adventure","destination","journey","explore","wanderlust","tourism"],Lifestyle:["lifestyle","home","family","daily life","routine","comfort","living","modern life"],Fashion:["fashion","style","clothing","model","trendy","outfit","runway","designer"],Retro:["retro","vintage","classic","old school","nostalgic","80s","90s","throwback"],Party:["party","celebration","dancing","nightlife","fun","festive","music","crowd"],Sport:["sport","fitness","exercise","athletic","training","competition","active","gym"],Games:["gaming","video games","esports","console","player","competition","online","fun"],Food:["food","cooking","cuisine","restaurant","chef","delicious","dining","meal"],Vlog:["vlog","blogger","camera","content","creator","recording","social media","lifestyle"],social:["social media","community","people","connection","sharing","networking","friends","online"]}[e]||["video","content"]}getMockVideos(e,t=15){return Array.from({length:t},(t,s)=>({id:`mock-${e}-${s}`,title:`${e} video ${s+1}`,thumbnail:`https://picsum.photos/400/300?random=${e}${s}`,videoUrl:"https://player.vimeo.com/external/291648067.hd.mp4?s=94998971682c6a3267e4cbd19d16a7b6c720f345&profile_id=175",duration:15+30*Math.random(),width:1920,height:1080,theme:e,tags:this.getThemeKeywords(e).slice(0,3),avgColor:"#"+Math.floor(16777215*Math.random()).toString(16),author:{name:`Mock Author ${s+1}`,url:"#"}}))}getUsageStats(){const e=(Date.now()-this.lastResetTime)/36e5;return{requestsThisHour:this.requestCount,maxRequestsPerHour:ye,timeUntilReset:Math.max(0,60-60*e),hasApiKey:!0}}},Te={maxAge:864e5,maxVideosPerTheme:50,enableLocalStorage:!0};const Se=new class{constructor(e={}){this.memoryCache=new Map,this.STORAGE_KEY="snapcut_video_cache",this.STORAGE_META_KEY="snapcut_video_cache_meta",this.config={...Te,...e},this.loadFromStorage(),this.startCleanupInterval()}get(e){const t=this.memoryCache.get(e);if(t)return t;if(this.config.enableLocalStorage){const t=this.getFromStorage(e);if(t)return this.memoryCache.set(e,t),t}return null}set(e,t){const s=t.slice(0,this.config.maxVideosPerTheme);this.memoryCache.set(e,s),this.config.enableLocalStorage&&this.saveToStorage(e,s)}has(e){return!!this.memoryCache.has(e)||!!this.config.enableLocalStorage&&this.hasInStorage(e)}delete(e){this.memoryCache.delete(e),this.config.enableLocalStorage&&this.deleteFromStorage(e)}clear(){if(this.memoryCache.clear(),this.config.enableLocalStorage)try{localStorage.removeItem(this.STORAGE_KEY),localStorage.removeItem(this.STORAGE_META_KEY)}catch(e){}}getStats(){const e={themes:Array.from(this.memoryCache.keys()),totalVideos:Array.from(this.memoryCache.values()).reduce((e,t)=>e+t.length,0)};let t={themes:[],totalVideos:0,sizeKB:0};if(this.config.enableLocalStorage)try{const e=localStorage.getItem(this.STORAGE_KEY);if(e){const s=JSON.parse(e);t={themes:Object.keys(s),totalVideos:Object.values(s).reduce((e,t)=>e+t.data.length,0),sizeKB:Math.round(e.length/1024)}}}catch(s){}return{memory:e,storage:t,config:this.config}}saveToStorage(e,t){try{const s=Date.now(),a=s+this.config.maxAge,r=this.loadStorageData();r[e]={data:t,timestamp:s,expiresAt:a},localStorage.setItem(this.STORAGE_KEY,JSON.stringify(r)),this.updateStorageMeta()}catch(s){if(s instanceof Error&&"QuotaExceededError"===s.name){this.clearExpiredFromStorage();try{const s=this.loadStorageData();s[e]={data:t,timestamp:Date.now(),expiresAt:Date.now()+this.config.maxAge},localStorage.setItem(this.STORAGE_KEY,JSON.stringify(s))}catch(a){}}}}getFromStorage(e){try{const t=localStorage.getItem(this.STORAGE_KEY);if(!t)return null;const s=JSON.parse(t)[e];return s?Date.now()>s.expiresAt?(this.deleteFromStorage(e),null):s.data:null}catch(t){return null}}hasInStorage(e){try{const t=localStorage.getItem(this.STORAGE_KEY);if(!t)return!1;const s=JSON.parse(t)[e];return s&&Date.now()<=s.expiresAt}catch(t){return!1}}deleteFromStorage(e){try{const t=this.loadStorageData();delete t[e],localStorage.setItem(this.STORAGE_KEY,JSON.stringify(t))}catch(t){}}loadStorageData(){try{const e=localStorage.getItem(this.STORAGE_KEY);return e?JSON.parse(e):{}}catch(e){return{}}}loadFromStorage(){if(this.config.enableLocalStorage)try{const e=this.loadStorageData(),t=Date.now();for(const[s,a]of Object.entries(e)){const e=s;a&&t<=a.expiresAt&&this.memoryCache.set(e,a.data)}this.clearExpiredFromStorage();this.memoryCache.size}catch(e){}}clearExpiredFromStorage(){try{const e=this.loadStorageData(),t=Date.now();let s=!1;for(const[a,r]of Object.entries(e)){const n=a;r&&t>r.expiresAt&&(delete e[n],s=!0)}s&&localStorage.setItem(this.STORAGE_KEY,JSON.stringify(e))}catch(e){}}updateStorageMeta(){try{const e={lastUpdate:Date.now(),version:"1.0"};localStorage.setItem(this.STORAGE_META_KEY,JSON.stringify(e))}catch(e){}}startCleanupInterval(){setInterval(()=>{this.clearExpiredFromStorage()},36e5)}};const Ce=new class{async getVideosByTheme(e,t=!1,s){try{const a=s&&s.length>0;if((a||t)&&Se.delete(e),!t&&!a){const t=Se.get(e);if(t&&t.length>0)return t}a&&s.join(", ");const r={theme:e,perPage:20,orientation:"portrait",minDuration:5,maxDuration:60},n=await Ne.searchVideosByTheme(r,s);return n.length>0&&!a&&Se.set(e,n),n}catch(a){const t=Se.get(e);return t||[]}}async getPopularVideosByTheme(e){try{const t=Se.get(e);if(t&&t.length>0)return t.slice(0,10);const s=await Ne.getPopularVideos(e,15);return s.length>0&&Se.set(e,s),s}catch(t){return[]}}async searchVideos(e){try{return await Ne.searchVideosByTheme(e)}catch(t){return[]}}async preloadPopularThemes(){const e=["travel","lifestyle","business","nature"].map(async e=>{try{Se.has(e)||(await this.getVideosByTheme(e),await new Promise(e=>setTimeout(e,500)))}catch(t){}});await Promise.allSettled(e)}clearCache(){Se.clear()}getStats(){const e=Se.getStats();return{cache:e,api:Ne.getUsageStats(),totalCachedVideos:e.memory.totalVideos,availableThemes:e.memory.themes}}isThemeAvailable(e){return Ne.getUsageStats().hasApiKey||Se.has(e)}async getVideoById(e,t){try{return(await this.getVideosByTheme(t)).find(t=>t.id===e)||null}catch(s){return null}}filterVideosByDuration(e,t,s){return e.filter(e=>!(t&&e.duration<t)&&!(s&&e.duration>s))}async getRecommendedVideos(e){try{const[t,s]=await Promise.all([this.getPopularVideosByTheme(e),this.getVideosByTheme(e)]),a=[...t],r=new Set(t.map(e=>e.id));return s.forEach(e=>{!r.has(e.id)&&a.length<25&&a.push(e)}),a}catch(t){return[]}}},Ee=()=>{const[e,t]=x.useState(null),[s,a]=x.useState(!1);return x.useEffect(()=>{const e=()=>{t(Ce.getStats())};e();const s=setInterval(e,5e3);return()=>clearInterval(s)},[]),e?ne.jsxs("div",{className:"fixed bottom-4 right-4 z-50",children:[ne.jsx("button",{onClick:()=>a(!s),className:"w-12 h-12 bg-blue-600 hover:bg-blue-700 rounded-full flex items-center justify-center text-white shadow-lg transition-colors",title:"Video System Debug",children:ne.jsx(D,{className:"w-5 h-5"})}),s&&ne.jsxs("div",{className:"absolute bottom-16 right-0 w-80 bg-slate-800 rounded-xl border border-slate-600 shadow-2xl p-4 text-sm",children:[ne.jsxs("div",{className:"flex items-center justify-between mb-3",children:[ne.jsxs("h3",{className:"font-semibold text-white flex items-center space-x-2",children:[ne.jsx("span",{children:"🎬"}),ne.jsx("span",{children:"Video System"})]}),ne.jsx("button",{onClick:()=>a(!1),className:"text-slate-400 hover:text-white",children:"✕"})]}),ne.jsxs("div",{className:"space-y-3",children:[ne.jsxs("div",{className:"bg-slate-700/50 rounded-lg p-3",children:[ne.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[ne.jsx(U,{className:"w-4 h-4 text-blue-400"}),ne.jsx("span",{className:"text-white font-medium",children:"Pexels API"})]}),ne.jsxs("div",{className:"space-y-1 text-xs",children:[ne.jsxs("div",{className:"flex justify-between",children:[ne.jsx("span",{className:"text-slate-400",children:"Status:"}),ne.jsx("span",{className:e.api.hasApiKey?"text-green-400":"text-orange-400",children:e.api.hasApiKey?"✅ Connected":"⚠️ Mock Mode"})]}),ne.jsxs("div",{className:"flex justify-between",children:[ne.jsx("span",{className:"text-slate-400",children:"Requests/Hour:"}),ne.jsxs("span",{className:"text-white",children:[e.api.requestsThisHour,"/",e.api.maxRequestsPerHour]})]}),ne.jsxs("div",{className:"flex justify-between",children:[ne.jsx("span",{className:"text-slate-400",children:"Reset in:"}),ne.jsxs("span",{className:"text-white",children:[Math.round(e.api.timeUntilReset),"min"]})]})]})]}),ne.jsxs("div",{className:"bg-slate-700/50 rounded-lg p-3",children:[ne.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[ne.jsx(I,{className:"w-4 h-4 text-green-400"}),ne.jsx("span",{className:"text-white font-medium",children:"Cache"})]}),ne.jsxs("div",{className:"space-y-1 text-xs",children:[ne.jsxs("div",{className:"flex justify-between",children:[ne.jsx("span",{className:"text-slate-400",children:"Memory:"}),ne.jsxs("span",{className:"text-white",children:[e.cache.memory.totalVideos," videos"]})]}),ne.jsxs("div",{className:"flex justify-between",children:[ne.jsx("span",{className:"text-slate-400",children:"Storage:"}),ne.jsxs("span",{className:"text-white",children:[e.cache.storage.totalVideos," videos (",e.cache.storage.sizeKB,"KB)"]})]}),ne.jsxs("div",{className:"flex justify-between",children:[ne.jsx("span",{className:"text-slate-400",children:"Themes:"}),ne.jsx("span",{className:"text-white",children:e.availableThemes.length})]})]})]}),ne.jsxs("div",{className:"bg-slate-700/50 rounded-lg p-3",children:[ne.jsx("div",{className:"text-white font-medium mb-2",children:"Cached Themes"}),ne.jsx("div",{className:"flex flex-wrap gap-1",children:e.availableThemes.length>0?e.availableThemes.map(e=>ne.jsx("span",{className:"px-2 py-1 bg-blue-600/20 text-blue-300 rounded text-xs",children:e},e)):ne.jsx("span",{className:"text-slate-400 text-xs",children:"None cached yet"})})]}),ne.jsxs("div",{className:"flex space-x-2 pt-2 border-t border-slate-600",children:[ne.jsx("button",{onClick:()=>{Ce.clearCache(),t(Ce.getStats())},className:"flex-1 px-3 py-2 bg-red-600/20 text-red-300 rounded-lg text-xs hover:bg-red-600/30 transition-colors",children:"Clear Cache"}),ne.jsx("button",{onClick:()=>{Ce.preloadPopularThemes()},className:"flex-1 px-3 py-2 bg-blue-600/20 text-blue-300 rounded-lg text-xs hover:bg-blue-600/30 transition-colors",children:"Preload"})]}),ne.jsx("div",{className:"pt-2 border-t border-slate-600",children:ne.jsxs("button",{onClick:()=>{be(async()=>{const{planVideoAssigner:e}=await Promise.resolve().then(()=>Qe);return{planVideoAssigner:e}},void 0).then(({planVideoAssigner:e})=>{e.shuffleAssignments()})},className:"w-full px-3 py-2 bg-purple-600/20 text-purple-300 rounded-lg text-xs hover:bg-purple-600/30 transition-colors flex items-center justify-center space-x-2",children:[ne.jsx("span",{children:"🎲"}),ne.jsx("span",{children:"Shuffle Videos"})]})})]})]})]}):null},ke={large:{width:1080,height:1920,quality:.9,format:"jpeg"},small:{width:540,height:960,quality:.8,format:"jpeg"}};async function Me(e,t,s=0){return new Promise((a,r)=>{if(e.readyState<e.HAVE_CURRENT_DATA){const n=()=>{e.removeEventListener("loadeddata",n),Re(e,t,s).then(a).catch(r)};return void e.addEventListener("loadeddata",n)}Re(e,t,s).then(a).catch(r)})}async function Re(e,t,s){return new Promise((a,r)=>{try{const n=document.createElement("canvas"),i=n.getContext("2d");if(!i)throw new Error("Failed to get canvas context");n.width=t.width,n.height=t.height;const l=e.currentTime,o=()=>{e.removeEventListener("seeked",o);try{const s=e.videoWidth/e.videoHeight,o=t.width/t.height;let d=t.width,c=t.height,m=0,h=0;s>o?(d=t.height*s,m=(t.width-d)/2):(c=t.width/s,h=(t.height-c)/2),i.fillStyle="#000000",i.fillRect(0,0,t.width,t.height),i.drawImage(e,m,h,d,c),n.toBlob(t=>{e.currentTime=l,t?a(t):r(new Error("Failed to create thumbnail blob"))},`image/${t.format}`,t.quality)}catch(s){e.currentTime=l,r(s)}};e.addEventListener("seeked",o),e.currentTime=Math.max(0,Math.min(s,e.duration-.1))}catch(n){r(n)}})}async function Ae(e,t=0,s){const a={...ke.large,...null==s?void 0:s.large},r={...ke.small,...null==s?void 0:s.small};try{const[s,n]=await Promise.all([Me(e,a,t),Me(e,r,t)]);return{large:s,small:n}}catch(n){throw new Error(`Thumbnail generation failed: ${n instanceof Error?n.message:"Unknown error"}`)}}function Le(e,t){const s=URL.createObjectURL(e),a=document.createElement("a");a.href=s,a.download=t,a.style.display="none",document.body.appendChild(a),a.click(),document.body.removeChild(a),setTimeout(()=>{URL.revokeObjectURL(s)},1e3)}const Pe=Object.freeze(Object.defineProperty({__proto__:null,DEFAULT_THUMBNAIL_CONFIGS:ke,downloadThumbnail:Le,generateThumbnailFromUrl:async function(e,t,s=0){return new Promise((a,r)=>{const n=document.createElement("video");n.crossOrigin="anonymous",n.preload="metadata";n.addEventListener("loadedmetadata",async()=>{try{const e=await Me(n,t,s);a(e)}catch(e){r(e)}finally{n.remove()}}),n.addEventListener("error",()=>{n.remove(),r(new Error(`Failed to load video from URL: ${e}`))}),n.src=e})},generateVideoThumbnail:Me,generateVideoThumbnails:Ae},Symbol.toStringTag,{value:"Module"}));var Fe,_e;(_e=Fe||(Fe={})).LOAD="LOAD",_e.EXEC="EXEC",_e.FFPROBE="FFPROBE",_e.WRITE_FILE="WRITE_FILE",_e.READ_FILE="READ_FILE",_e.DELETE_FILE="DELETE_FILE",_e.RENAME="RENAME",_e.CREATE_DIR="CREATE_DIR",_e.LIST_DIR="LIST_DIR",_e.DELETE_DIR="DELETE_DIR",_e.ERROR="ERROR",_e.DOWNLOAD="DOWNLOAD",_e.PROGRESS="PROGRESS",_e.LOG="LOG",_e.MOUNT="MOUNT",_e.UNMOUNT="UNMOUNT";const Oe=(()=>{let e=0;return()=>e++})(),De=new Error("ffmpeg is not loaded, call `await ffmpeg.load()` first"),Ue=new Error("called FFmpeg.terminate()");class Ie{constructor(){h(this,e,null),h(this,t,{}),h(this,s,{}),h(this,a,[]),h(this,r,[]),d(this,"loaded",!1),h(this,n,()=>{m(this,e)&&(m(this,e).onmessage=({data:{id:e,type:n,data:i}})=>{switch(n){case Fe.LOAD:this.loaded=!0,m(this,t)[e](i);break;case Fe.MOUNT:case Fe.UNMOUNT:case Fe.EXEC:case Fe.FFPROBE:case Fe.WRITE_FILE:case Fe.READ_FILE:case Fe.DELETE_FILE:case Fe.RENAME:case Fe.CREATE_DIR:case Fe.LIST_DIR:case Fe.DELETE_DIR:m(this,t)[e](i);break;case Fe.LOG:m(this,a).forEach(e=>e(i));break;case Fe.PROGRESS:m(this,r).forEach(e=>e(i));break;case Fe.ERROR:m(this,s)[e](i)}delete m(this,t)[e],delete m(this,s)[e]})}),h(this,i,({type:a,data:r},n=[],i)=>m(this,e)?new Promise((l,o)=>{const d=Oe();m(this,e)&&m(this,e).postMessage({id:d,type:a,data:r},n),m(this,t)[d]=l,m(this,s)[d]=o,null==i||i.addEventListener("abort",()=>{o(new DOMException(`Message # ${d} was aborted`,"AbortError"))},{once:!0})}):Promise.reject(De)),d(this,"load",({classWorkerURL:t,...s}={},{signal:a}={})=>(m(this,e)||(u(this,e,t?new Worker(new URL(t,import.meta.url),{type:"module"}):new Worker(new URL("/assets/worker-BU9fmUEi.js",import.meta.url),{type:"module"})),m(this,n).call(this)),m(this,i).call(this,{type:Fe.LOAD,data:s},void 0,a))),d(this,"exec",(e,t=-1,{signal:s}={})=>m(this,i).call(this,{type:Fe.EXEC,data:{args:e,timeout:t}},void 0,s)),d(this,"ffprobe",(e,t=-1,{signal:s}={})=>m(this,i).call(this,{type:Fe.FFPROBE,data:{args:e,timeout:t}},void 0,s)),d(this,"terminate",()=>{const a=Object.keys(m(this,s));for(const e of a)m(this,s)[e](Ue),delete m(this,s)[e],delete m(this,t)[e];m(this,e)&&(m(this,e).terminate(),u(this,e,null),this.loaded=!1)}),d(this,"writeFile",(e,t,{signal:s}={})=>{const a=[];return t instanceof Uint8Array&&a.push(t.buffer),m(this,i).call(this,{type:Fe.WRITE_FILE,data:{path:e,data:t}},a,s)}),d(this,"mount",(e,t,s)=>m(this,i).call(this,{type:Fe.MOUNT,data:{fsType:e,options:t,mountPoint:s}},[])),d(this,"unmount",e=>m(this,i).call(this,{type:Fe.UNMOUNT,data:{mountPoint:e}},[])),d(this,"readFile",(e,t="binary",{signal:s}={})=>m(this,i).call(this,{type:Fe.READ_FILE,data:{path:e,encoding:t}},void 0,s)),d(this,"deleteFile",(e,{signal:t}={})=>m(this,i).call(this,{type:Fe.DELETE_FILE,data:{path:e}},void 0,t)),d(this,"rename",(e,t,{signal:s}={})=>m(this,i).call(this,{type:Fe.RENAME,data:{oldPath:e,newPath:t}},void 0,s)),d(this,"createDir",(e,{signal:t}={})=>m(this,i).call(this,{type:Fe.CREATE_DIR,data:{path:e}},void 0,t)),d(this,"listDir",(e,{signal:t}={})=>m(this,i).call(this,{type:Fe.LIST_DIR,data:{path:e}},void 0,t)),d(this,"deleteDir",(e,{signal:t}={})=>m(this,i).call(this,{type:Fe.DELETE_DIR,data:{path:e}},void 0,t))}on(e,t){"log"===e?m(this,a).push(t):"progress"===e&&m(this,r).push(t)}off(e,t){"log"===e?u(this,a,m(this,a).filter(e=>e!==t)):"progress"===e&&u(this,r,m(this,r).filter(e=>e!==t))}}var $e,Ve;e=new WeakMap,t=new WeakMap,s=new WeakMap,a=new WeakMap,r=new WeakMap,n=new WeakMap,i=new WeakMap,(Ve=$e||($e={})).MEMFS="MEMFS",Ve.NODEFS="NODEFS",Ve.NODERAWFS="NODERAWFS",Ve.IDBFS="IDBFS",Ve.WORKERFS="WORKERFS",Ve.PROXYFS="PROXYFS";const Be=new Error("failed to get response body reader"),ze=new Error("failed to complete download"),qe=async e=>{let t;if("string"==typeof e)t=/data:_data\/([a-zA-Z]*);base64,([^"]*)/.test(e)?atob(e.split(",")[1]).split("").map(e=>e.charCodeAt(0)):await(await fetch(e)).arrayBuffer();else if(e instanceof URL)t=await(await fetch(e)).arrayBuffer();else{if(!(e instanceof File||e instanceof Blob))return new Uint8Array;t=await(s=e,new Promise((e,t)=>{const a=new FileReader;a.onload=()=>{const{result:t}=a;t instanceof ArrayBuffer?e(new Uint8Array(t)):e(new Uint8Array)},a.onerror=e=>{var s,a;t(Error(`File could not be read! Code=${(null==(a=null==(s=null==e?void 0:e.target)?void 0:s.error)?void 0:a.code)||-1}`))},a.readAsArrayBuffer(s)}))}var s;return new Uint8Array(t)},We=async(e,t,s=!1,a)=>{const r=s?await(async(e,t)=>{var s;const a=await fetch(e);let r;try{const n=parseInt(a.headers.get("Content-Length")||"-1"),i=null==(s=a.body)?void 0:s.getReader();if(!i)throw Be;const l=[];let o=0;for(;;){const{done:s,value:a}=await i.read(),r=a?a.length:0;if(s){if(-1!=n&&n!==o)throw ze;t&&t({url:e,total:n,received:o,delta:r,done:s});break}l.push(a),o+=r,t&&t({url:e,total:n,received:o,delta:r,done:s})}const d=new Uint8Array(o);let c=0;for(const e of l)d.set(e,c),c+=e.length;r=d.buffer}catch(n){r=await a.arrayBuffer()}return r})(e,a):await(await fetch(e)).arrayBuffer(),n=new Blob([r],{type:t});return URL.createObjectURL(n)};function Ke(e){try{return new URL(e,window.location.origin).toString()}catch{return e}}const Ge=new class{constructor(){this.isLoaded=!1,this.ffmpeg=new Ie}async initialize(e){if(!this.isLoaded)try{null==e||e({stage:"initializing",progress:0,message:"Loading FFmpeg..."});window.SharedArrayBuffer;let a=!1;try{null==e||e({stage:"initializing",progress:25,message:"Loading FFmpeg from local files..."});const t=await We(Ke("/ffmpeg/ffmpeg-core.js"),"text/javascript"),s=await We(Ke("/ffmpeg/ffmpeg-core.wasm"),"application/wasm"),r=await We(Ke("/ffmpeg/ffmpeg-core.worker.js"),"text/javascript");await this.ffmpeg.load({coreURL:t,wasmURL:s,workerURL:r}),a=!0}catch(t){const r=["https://unpkg.com/@ffmpeg/core@0.12.6/dist/umd","https://cdn.jsdelivr.net/npm/@ffmpeg/core@0.12.6/dist/umd","https://cdnjs.cloudflare.com/ajax/libs/ffmpeg-core/0.12.10/umd"];for(const n of r)try{null==e||e({stage:"initializing",progress:50,message:`Loading FFmpeg from ${n} (fallback)...`});const t=await We(`${n}/ffmpeg-core.js`,"text/javascript"),s=await We(`${n}/ffmpeg-core.wasm`,"application/wasm");let r;try{r=await We(`${n}/ffmpeg-core.worker.js`,"text/javascript")}catch{r=await We(`${n}/814.ffmpeg.js`,"text/javascript")}await this.ffmpeg.load({coreURL:t,wasmURL:s,workerURL:r}),a=!0;break}catch(s){if(n===r[r.length-1])throw new Error("All FFmpeg sources failed. Please check your internet connection and SharedArrayBuffer support.")}}if(!a)throw new Error("Failed to load FFmpeg from all sources");this.ffmpeg.on("progress",({progress:t})=>{null==e||e({stage:"encoding",progress:Math.round(100*t),message:`Encoding video... ${Math.round(100*t)}%`})}),this.isLoaded=!0,null==e||e({stage:"initializing",progress:100,message:"FFmpeg loaded successfully"})}catch(s){throw new Error("Failed to initialize video editor")}}createVideoSegments(e,t,s,a,r){const n=[],i=[...e].sort((e,t)=>e.time-t.time),l=i.length>0?i[0].time:a,o=t.get(1);o&&n.push({planIndex:1,video:o,startTime:s,endTime:Math.min(l,a),trimSettings:r.get(1)});for(let d=0;d<i.length;d++){const e=i[d],l=i[d+1],o=d+2,c=t.get(o);c&&e.time<a&&n.push({planIndex:o,video:c,startTime:Math.max(e.time,s),endTime:Math.min(l?l.time:a,a),trimSettings:r.get(o)})}return n.filter(e=>e.endTime>e.startTime)}async downloadAndPrepareVideos(e,t){null==t||t({stage:"downloading",progress:0,message:`Downloading ${e.length} videos...`});for(let a=0;a<e.length;a++){const r=e[a];try{null==t||t({stage:"downloading",progress:a/e.length*100,message:`Downloading video ${a+1}/${e.length}...`});const s=await qe(r.video.videoUrl);await this.ffmpeg.writeFile(`video_${r.planIndex}.mp4`,s)}catch(s){throw new Error(`Failed to download video for plan ${r.planIndex}`)}}}generateFFmpegCommand(e,t,s,a){const r=s.compressions[a],n=[];e.forEach((e,t)=>{n.push("-i",`video_${e.planIndex}.mp4`)}),n.push("-i","audio.wav");const i=[];e.forEach((e,t)=>{var s,a;const n=e.endTime-e.startTime,l=(null==(s=e.trimSettings)?void 0:s.startTime)||0,o=(null==(a=e.trimSettings)?void 0:a.endTime)||e.video.duration,d=Math.min(o-l,n);i.push(`[${t}:v]trim=start=${l}:duration=${d},setpts=PTS-STARTPTS,scale=${r.width}:${r.height}:force_original_aspect_ratio=decrease,pad=${r.width}:${r.height}:(ow-iw)/2:(oh-ih)/2[v${t}]`)});const l=e.map((e,t)=>`[v${t}]`).join("");return i.push(`${l}concat=n=${e.length}:v=1:a=0[outv]`),n.push("-filter_complex",i.join(";")),n.push("-map","[outv]"),n.push("-map",`${e.length}:a`),n.push("-c:v","libx264"),n.push("-b:v",r.bitrate),n.push("-c:a","aac"),n.push("-b:a","128k"),n.push("-movflags","+faststart"),n.push("-shortest"),n.push(`output_${a}.mp4`),n}async exportFinalVideo(e,t,s,a,r,n=new Map,i="high",l={compressions:{high:{width:720,height:1280,bitrate:"2M"},medium:{width:360,height:640,bitrate:"800k"}},thumbnails:ke},o){var d;try{await this.initialize(o);const c=this.createVideoSegments(e,t,a,r,n);if(0===c.length)throw new Error("No video segments to export");null==o||o({stage:"processing",progress:0,message:"Preparing video export..."}),await this.downloadAndPrepareVideos(c,o);const m=await qe(s);await this.ffmpeg.writeFile("audio.wav",m),null==o||o({stage:"encoding",progress:0,message:"Encoding final video..."});const h=this.generateFFmpegCommand(c,s,l,i);await this.ffmpeg.exec(h);const u=await this.ffmpeg.readFile(`output_${i}.mp4`),x=new Blob([u],{type:"video/mp4"});null==o||o({stage:"thumbnails",progress:0,message:"Generating thumbnails..."});const p=document.createElement("video");p.src=c[0].video.videoUrl,p.crossOrigin="anonymous",await new Promise(e=>{p.addEventListener("loadedmetadata",e),p.load()});const g=await Ae(p,(null==(d=c[0].trimSettings)?void 0:d.startTime)||0,l.thumbnails);null==o||o({stage:"complete",progress:100,message:"Export complete!"});const f=l.compressions[i];return{videoBlob:x,thumbnailLarge:g.large,thumbnailSmall:g.small,metadata:{duration:r-a,resolution:`${f.width}x${f.height}`,fileSize:x.size,compression:i}}}catch(c){throw new Error(`Video export failed: ${c instanceof Error?c.message:"Unknown error"}`)}}async cleanup(){try{const e=await this.ffmpeg.listDir("/");for(const t of e)"."!==t.name&&".."!==t.name&&await this.ffmpeg.deleteFile(t.name)}catch(e){}}};function Ye(){if("undefined"==typeof SharedArrayBuffer)return{available:!1,reason:"SharedArrayBuffer not supported by browser",suggestions:["Use a modern browser (Chrome 68+, Firefox 79+, Safari 15.2+)","Ensure you are on HTTPS (required for SharedArrayBuffer)"]};try{return new SharedArrayBuffer(1),{available:!0,reason:"SharedArrayBuffer is fully available",suggestions:["FFmpeg.js should work correctly"]}}catch(e){return{available:!1,reason:"SharedArrayBuffer blocked by CORS policy",suggestions:["Check that Cross-Origin-Opener-Policy: same-origin header is set","Check that Cross-Origin-Embedder-Policy: require-corp or credentialless header is set","Verify headers in DevTools -> Network -> HTML response -> Headers","Clear Netlify cache and redeploy if headers were recently added"]}}}const Xe=({audioFile:e,cutMarkers:t,startTime:s,endTime:a,videoAssignments:r,videoTrimSettings:n})=>{const[i,l]=x.useState(!1),[o,d]=x.useState(null),[c,m]=x.useState({json:"pending",audio:"pending",video720p:"pending",video360p:"pending",thumbnailLarge:"pending",thumbnailSmall:"pending"}),[h,u]=x.useState(null),p=x.useMemo(()=>xe.extractSettingsFromDOM()||{category:"Travel",templateNumber:"006",musicId:"012"},[]),g=x.useMemo(()=>{const t=a-s,n=t>0&&t<=60,i=r.size>0;return n&&i&&!!e},[e,r.size,s,a]),f=x.useCallback((e,t,s,a=!1)=>{d({step:e,progress:t,message:s,isComplete:a})},[]),b=x.useCallback((e,t)=>{m(s=>({...s,[e]:t}))},[]),v=x.useCallback(()=>{const e=Date.now()/1e3,r=a-s,n=xe.createContext(p,t,r),i=xe.generateMusicFilename(n,s,a),l=[...t].sort((e,t)=>e.time-t.time),o=[],d=l.length>0?l[0].time:a,c=Math.min(d,a)-s;c>0&&o.push({duration:c,startTime:0,mediaType:"video",fileName:"placeholder_video_1.mp4",playbackSpeed:1,isMuted:!0});for(let t=0;t<l.length;t++){const e=l[t],r=l[t+1],n=(r?Math.min(r.time,a):a)-e.time;n>0&&o.push({duration:n,startTime:e.time-s,mediaType:"video",fileName:`placeholder_video_${t+2}.mp4`,playbackSpeed:1,isMuted:!0})}return{id:crypto.randomUUID().toUpperCase(),title:xe.generateProjectFilename(n).replace(".json",""),lastModificationDate:e,editionProject:{mainTimeline:o,aspectRatio:{r_9_16:{}},superpositionTimeline:[],audioTimeline:[{duration:r,startTime:0,fileName:i,gain:1,playbackSpeed:1,fileTrimStart:s,isMuted:!1}]}}},[e,t,s,a,p]),j=x.useCallback(async()=>{if(g){l(!0),u(null),m({json:"pending",audio:"pending",video720p:"pending",video360p:"pending",thumbnailLarge:"pending",thumbnailSmall:"pending"});try{const l=xe.createContext(p,t,a-s);f("JSON Export",10,"Generating Snapcut project file...");try{const e=v(),t=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),s=xe.generateProjectFilename(l),a=URL.createObjectURL(t),r=document.createElement("a");r.href=a,r.download=s,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(a),b("json","success")}catch(i){throw b("json","error"),new Error(`JSON export failed: ${i}`)}f("Audio Export",25,"Trimming and exporting audio...");try{const t=await ue(e.file,{startTime:s,endTime:a,originalFileName:e.name}),r=xe.generateMusicFilename(l,s,a),n=URL.createObjectURL(t),i=document.createElement("a");i.href=n,i.download=r,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(n),b("audio","success")}catch(i){throw b("audio","error"),new Error(`Audio export failed: ${i}`)}f("Video Export",40,"Initializing video export...");let d=!1,m="";try{f("Video Export",45,"Exporting 720p video...");const i=await Ge.exportFinalVideo(t,r,e.file,s,a,n,"high",{compressions:{high:{width:720,height:1280,bitrate:"2M"},medium:{width:360,height:640,bitrate:"800k"}},thumbnails:{large:{width:1080,height:1920,quality:.9,format:"jpeg"},small:{width:540,height:960,quality:.8,format:"jpeg"}}},e=>{"encoding"===e.stage&&f("Video Export",45+15*e.progress,`720p: ${e.message}`)}),o=xe.generateFinalVideoFilename(l,"high"),d=URL.createObjectURL(i.videoBlob),c=document.createElement("a");c.href=d,c.download=o,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(d),b("video720p","success"),f("Video Export",65,"Exporting 360p video...");const m=await Ge.exportFinalVideo(t,r,e.file,s,a,n,"medium",{compressions:{high:{width:720,height:1280,bitrate:"2M"},medium:{width:360,height:640,bitrate:"800k"}},thumbnails:{large:{width:1080,height:1920,quality:.9,format:"jpeg"},small:{width:540,height:960,quality:.8,format:"jpeg"}}},e=>{"encoding"===e.stage&&f("Video Export",65+15*e.progress,`360p: ${e.message}`)}),h=xe.generateFinalVideoFilename(l,"medium"),u=URL.createObjectURL(m.videoBlob),x=document.createElement("a");x.href=u,x.download=h,document.body.appendChild(x),x.click(),document.body.removeChild(x),URL.revokeObjectURL(u),b("video360p","success"),f("Thumbnails",85,"Generating thumbnails...");const p=xe.generateThumbnailFilename(l,"large",1080,1920,"jpeg");Le(i.thumbnailLarge,p),b("thumbnailLarge","success"),await new Promise(e=>setTimeout(e,500));const g=xe.generateThumbnailFilename(l,"small",540,960,"jpeg");Le(i.thumbnailSmall,g),b("thumbnailSmall","success")}catch(i){d=!0,m=i instanceof Error?i.message:"Unknown video export error",b("video720p","error"),b("video360p","error");try{f("Thumbnails",85,"Generating thumbnails (fallback mode)...");const e=r.get(1);if(e){const{generateThumbnailFromUrl:t,downloadThumbnail:s}=await be(async()=>{const{generateThumbnailFromUrl:e,downloadThumbnail:t}=await Promise.resolve().then(()=>Pe);return{generateThumbnailFromUrl:e,downloadThumbnail:t}},void 0),a=await t(e.videoUrl,{width:1080,height:1920,quality:.9,format:"jpeg"});s(a,xe.generateThumbnailFilename(l,"large",1080,1920,"jpeg")),b("thumbnailLarge","success"),await new Promise(e=>setTimeout(e,500));const r=await t(e.videoUrl,{width:540,height:960,quality:.8,format:"jpeg"});s(r,xe.generateThumbnailFilename(l,"small",540,960,"jpeg")),b("thumbnailSmall","success")}else b("thumbnailLarge","error"),b("thumbnailSmall","error")}catch(o){b("thumbnailLarge","error"),b("thumbnailSmall","error")}}f("Complete",100,d?"Export completed with limitations":"All files exported successfully!",!0),setTimeout(()=>{const e=`${p.category}_${p.templateNumber}_${p.musicId}_${t.length+1}_${Math.ceil(a-s)}s`;if(d){const t=2+("success"===c.thumbnailLarge?1:0)+("success"===c.thumbnailSmall?1:0);alert(`⚠️ Export Completed with Limitations!\n\n✅ ${t} files downloaded successfully:\n• ${e}_project.json\n• ${e}_music_trimmed_*.wav${"success"===c.thumbnailLarge?`\n• ${e}_thumbnail_large_*.jpeg`:""}${"success"===c.thumbnailSmall?`\n• ${e}_thumbnail_small_*.jpeg`:""}\n\n❌ Video export failed (FFmpeg not available in production)\n💡 Use the individual raw videos from the Pexels panel instead\n\n🚀 JSON and Audio are ready for Snapcut!`)}else alert(`🎉 Export Complete!\n\n✅ All 6 files downloaded:\n• ${e}_project.json\n• ${e}_music_trimmed_*.wav\n• ${e}_render_HD.mp4 (720p)\n• ${e}_render_SD.mp4 (360p)\n• ${e}_thumbnail_large_*.jpeg\n• ${e}_thumbnail_small_*.jpeg\n\n🚀 Ready for Snapcut!`)},1e3)}catch(i){u(i instanceof Error?i.message:"Export failed")}finally{l(!1),setTimeout(()=>{d(null)},3e3)}}},[g,t,s,a,e,r,n,p,v,f,b]),w=e=>{switch(e){case"pending":return ne.jsx("div",{className:"w-4 h-4 rounded-full bg-slate-400"});case"success":return ne.jsx(q,{className:"w-4 h-4 text-green-500"});case"error":return ne.jsx(V,{className:"w-4 h-4 text-red-500"})}};return ne.jsx("div",{className:"space-y-6",children:ne.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[ne.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[ne.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-green-500 to-blue-500 rounded-xl flex items-center justify-center",children:ne.jsx($,{className:"w-6 h-6 text-white"})}),ne.jsxs("div",{children:[ne.jsx("h2",{className:"text-xl font-bold text-slate-800",children:"Complete Export"}),ne.jsx("p",{className:"text-sm text-slate-600",children:(null==o?void 0:o.isComplete)&&o.message.includes("limitations")?"Downloaded available files: JSON, Audio, Thumbnails (video export failed)":"Download all 6 files: JSON, Audio, 2 Videos, 2 Thumbnails"})]})]}),i&&ne.jsx("div",{className:"mb-6 p-4 bg-slate-50 rounded-lg",children:ne.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3 text-sm",children:[ne.jsxs("div",{className:"flex items-center gap-2",children:[w(c.json),ne.jsx("span",{children:"Project JSON"})]}),ne.jsxs("div",{className:"flex items-center gap-2",children:[w(c.audio),ne.jsx("span",{children:"Audio Track"})]}),ne.jsxs("div",{className:"flex items-center gap-2",children:[w(c.video720p),ne.jsx("span",{children:"Video 720p"})]}),ne.jsxs("div",{className:"flex items-center gap-2",children:[w(c.video360p),ne.jsx("span",{children:"Video 360p"})]}),ne.jsxs("div",{className:"flex items-center gap-2",children:[w(c.thumbnailLarge),ne.jsx("span",{children:"Thumbnail Large"})]}),ne.jsxs("div",{className:"flex items-center gap-2",children:[w(c.thumbnailSmall),ne.jsx("span",{children:"Thumbnail Small"})]})]})}),o&&ne.jsxs("div",{className:"mb-6",children:[ne.jsxs("div",{className:"flex justify-between items-center mb-2",children:[ne.jsx("span",{className:"text-sm font-medium text-slate-700",children:o.step}),ne.jsxs("span",{className:"text-sm text-slate-500",children:[o.progress,"%"]})]}),ne.jsx("div",{className:"w-full bg-slate-200 rounded-full h-2",children:ne.jsx("div",{className:"bg-gradient-to-r from-green-500 to-blue-500 h-2 rounded-full transition-all duration-300",style:{width:`${o.progress}%`}})}),ne.jsx("div",{className:"mt-1 text-xs text-slate-600",children:o.message})]}),h&&ne.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:ne.jsxs("div",{className:"flex items-center gap-2 text-red-700 text-sm",children:[ne.jsx(V,{className:"w-4 h-4"}),ne.jsxs("span",{children:[ne.jsx("strong",{children:"Export Failed:"})," ",h]})]})}),ne.jsxs("div",{className:"flex flex-col items-center gap-4",children:[ne.jsx("button",{onClick:j,disabled:!g||i,className:"w-full max-w-md flex items-center justify-center gap-3 p-4 bg-gradient-to-r from-green-500 to-blue-500 text-white rounded-lg hover:from-green-600 hover:to-blue-600 disabled:opacity-50 disabled:cursor-not-allowed font-medium transition-all text-lg",children:i?ne.jsxs(ne.Fragment,{children:[ne.jsx(B,{className:"w-5 h-5 animate-spin"}),"Exporting..."]}):ne.jsxs(ne.Fragment,{children:[ne.jsx(z,{className:"w-5 h-5"}),"Download All (6 Files)"]})}),ne.jsxs("div",{className:"text-center text-sm text-slate-500 space-y-1",children:[ne.jsx("p",{children:"Includes: JSON Template, Audio Track, Videos (720p + 360p), Thumbnails (Large + Small)"}),(()=>{const e=Ye();return e.available?null:ne.jsxs("div",{className:"mt-2 p-3 bg-amber-500/10 border border-amber-500/20 rounded-lg text-amber-200 text-xs space-y-2",children:[ne.jsxs("div",{className:"flex items-center gap-2",children:[ne.jsx(V,{className:"w-4 h-4"}),ne.jsxs("span",{className:"font-medium",children:["⚠️ FFmpeg.js Limited: ",e.reason]})]}),ne.jsx("button",{onClick:()=>{!function(){const e=Ye();e.suggestions.forEach((e,t)=>{})}(),alert(`SharedArrayBuffer Diagnostic:\n\n${e.reason}\n\nSuggestions:\n${e.suggestions.map((e,t)=>`${t+1}. ${e}`).join("\n")}\n\nCheck console for detailed diagnostic.`)},className:"text-amber-300 hover:text-amber-100 underline text-xs",children:"🔍 Run Diagnostic (check console)"})]})})(),!g&&ne.jsx("p",{className:"text-red-500",children:e?0===r.size?"Assign videos to plans first":a-s>30?"Reduce duration to ≤ 30 seconds":a-s<=0?"Set valid audio trim points":"Ready to export!":"Upload audio file first"})]})]})]})})},He=[{value:"Travel",label:"Travel",icon:"✈️"},{value:"Lifestyle",label:"Lifestyle",icon:"🏠"},{value:"Fashion",label:"Fashion",icon:"👗"},{value:"Retro",label:"Retro",icon:"📼"},{value:"Party",label:"Party",icon:"🎉"},{value:"Sport",label:"Sport",icon:"⚽"},{value:"Games",label:"Games",icon:"🎮"},{value:"Food",label:"Food",icon:"🍴"},{value:"Vlog",label:"Vlog",icon:"📱"},{value:"social",label:"Social",icon:"📢"}],Je=({cutMarkers:e,startTime:t,endTime:s,onVideoAssignmentsChange:a})=>{const[r,n]=x.useState(!1),[i,l]=x.useState("Travel"),[o,d]=x.useState(""),[c,m]=x.useState(!1),[h,u]=x.useState([]),[p,g]=x.useState(new Map),[f,b]=x.useState(1),[v,j]=x.useState(!0),[w,y]=x.useState(""),[N,T]=x.useState(0),[C,E]=x.useState(60),k=e.length+1,M=x.useMemo(()=>{const a=xe.extractSettingsFromDOM()||{category:i,templateNumber:Math.floor(t).toString().padStart(3,"0"),musicId:Math.floor(s).toString().padStart(3,"0")},r=xe.createContext(a,e,s-t);return xe.generateProjectFilename(r)},[i,t,s,k,e]),R=x.useMemo(()=>{let e=[...h];return w&&(e=e.filter(e=>e.author.name===w)),e=e.filter(e=>e.duration>=N&&e.duration<=C),e},[h,w,N,C]),A=x.useMemo(()=>Array.from(new Set(h.map(e=>e.author.name))).sort(),[h]),L=x.useCallback(()=>{y(""),T(0),E(60)},[]),P=x.useCallback(e=>{y(w===e?"":e)},[w]),_=x.useCallback(async(e=!1)=>{if(!c){m(!0);try{const t=e?f+1:1,s=o.trim()?o.split(",").map(e=>e.trim()).filter(e=>e.length>0):[],a=await Ne.searchVideosByTheme({theme:i,perPage:30,page:t,orientation:"portrait"},s);e?(u(e=>[...e,...a]),b(t)):(u(a),b(1)),j(30===a.length)}catch(t){alert("Erreur lors de la recherche de vidéos. Veuillez réessayer.")}finally{m(!1)}}},[i,o,c,f]),O=x.useCallback(()=>{_(!0)},[_]),D=x.useCallback(()=>{if(0===R.length)return void alert(0===h.length?"Lancez d'abord une recherche de vidéos !":"Aucune vidéo ne correspond aux filtres actuels !");const e=new Map,t=[...R];for(let s=1;s<=k;s++)if(t.length>0){const a=Math.floor(Math.random()*t.length),r=t.splice(a,1)[0];e.set(s,r)}g(e),a(e)},[R,h.length,k,a]),U=x.useCallback(async()=>{if(0===p.size)return void alert("Aucune vidéo assignée à télécharger !");const e=M.replace(".json","").replace("_project","");m(!0);try{let t=1;for(const[s,a]of p.entries()){const s=`${e}_video${t}.mp4`,r=await fetch(a.videoUrl),n=await r.blob(),i=URL.createObjectURL(n),l=document.createElement("a");l.href=i,l.download=s,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(i),await new Promise(e=>setTimeout(e,500)),t++}}catch(t){alert("Erreur lors du téléchargement des vidéos.")}finally{m(!1)}},[p,M]);return r?ne.jsxs("div",{className:"bg-slate-700/30 rounded-xl p-6 border border-slate-600/30 space-y-6",children:[ne.jsxs("div",{className:"flex items-center justify-between",children:[ne.jsxs("h3",{className:"text-lg font-semibold text-white flex items-center space-x-2",children:[ne.jsx(W,{className:"w-5 h-5"}),ne.jsx("span",{children:"Pexels Video Manager"})]}),ne.jsx("button",{onClick:()=>n(!1),className:"text-slate-400 hover:text-white p-1",children:ne.jsx(F,{className:"w-5 h-5"})})]}),ne.jsxs("div",{children:[ne.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Thème"}),ne.jsx("div",{className:"grid grid-cols-5 gap-2",children:He.map(e=>ne.jsxs("button",{onClick:()=>l(e.value),className:"p-3 rounded-lg border-2 transition-all duration-200 text-center "+(i===e.value?"border-blue-400 bg-blue-400/20 text-white":"border-slate-600 bg-slate-700/50 text-slate-300 hover:border-slate-500"),children:[ne.jsx("div",{className:"text-lg mb-1",children:e.icon}),ne.jsx("div",{className:"text-xs font-medium",children:e.label})]},e.value))})]}),ne.jsxs("div",{children:[ne.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Nom du projet (généré automatiquement)"}),ne.jsx("div",{className:"w-full px-3 py-2 bg-slate-700/50 border border-slate-600 rounded-lg text-white text-sm font-mono",children:M.replace(".json","")}),ne.jsxs("div",{className:"text-xs text-slate-400 mt-1",children:["Format: ",i,"_",Math.floor(t).toString().padStart(3,"0"),"_",Math.floor(s).toString().padStart(3,"0"),"_",k,"_",Math.floor(s-t),"s_project"]})]}),ne.jsxs("div",{children:[ne.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Mots-clés (séparés par des virgules, optionnel)"}),ne.jsx("input",{type:"text",value:o,onChange:e=>d(e.target.value),placeholder:"nature, sunset, ocean...",className:"w-full px-3 py-2 bg-slate-700/50 border border-slate-600 rounded-lg text-white text-sm focus:border-blue-400 focus:outline-none transition-colors"})]}),h.length>0&&ne.jsxs("div",{className:"border-t border-slate-600 pt-4",children:[ne.jsxs("div",{className:"flex items-center justify-between mb-3",children:[ne.jsxs("h4",{className:"text-sm font-medium text-gray-300 flex items-center space-x-2",children:[ne.jsx(K,{className:"w-4 h-4"}),ne.jsx("span",{children:"Filtres"})]}),ne.jsx("button",{onClick:L,className:"text-xs text-slate-400 hover:text-white transition-colors",children:"Réinitialiser"})]}),ne.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[ne.jsxs("div",{children:[ne.jsx("label",{className:"block text-xs font-medium text-gray-400 mb-2",children:"Durée (secondes)"}),ne.jsxs("div",{className:"flex items-center space-x-2",children:[ne.jsx("input",{type:"number",value:N,onChange:e=>T(Math.max(0,parseInt(e.target.value)||0)),placeholder:"Min",className:"w-full px-2 py-1 bg-slate-700/50 border border-slate-600 rounded text-white text-xs focus:border-blue-400 focus:outline-none"}),ne.jsx("span",{className:"text-slate-400 text-xs",children:"-"}),ne.jsx("input",{type:"number",value:C,onChange:e=>E(Math.max(N,parseInt(e.target.value)||60)),placeholder:"Max",className:"w-full px-2 py-1 bg-slate-700/50 border border-slate-600 rounded text-white text-xs focus:border-blue-400 focus:outline-none"})]})]}),ne.jsxs("div",{children:[ne.jsxs("label",{className:"block text-xs font-medium text-gray-400 mb-2",children:["Auteur (",A.length,")"]}),ne.jsxs("select",{value:w,onChange:e=>y(e.target.value),className:"w-full px-2 py-1 bg-slate-700/50 border border-slate-600 rounded text-white text-xs focus:border-blue-400 focus:outline-none",children:[ne.jsx("option",{value:"",children:"Tous les auteurs"}),A.map(e=>ne.jsx("option",{value:e,children:e},e))]})]})]}),ne.jsxs("div",{className:"mt-2 text-xs text-slate-400",children:[R.length," vidéo",1!==R.length?"s":""," correspondant",1!==R.length?"es":"e",w&&` • Auteur: ${w}`,(N>0||C<60)&&` • Durée: ${N}-${C}s`]})]}),ne.jsxs("div",{className:"flex items-center space-x-3",children:[ne.jsxs("button",{onClick:()=>{b(1),j(!0),_(!1)},disabled:c,className:"flex-1 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-600/50 text-white font-medium py-2 px-4 rounded-lg transition-colors flex items-center justify-center space-x-2",children:[c&&1===f?ne.jsx(G,{className:"w-4 h-4 animate-spin"}):ne.jsx(W,{className:"w-4 h-4"}),ne.jsx("span",{children:"Rechercher"})]}),ne.jsxs("button",{onClick:D,disabled:0===R.length||c,className:"bg-purple-600 hover:bg-purple-700 disabled:bg-purple-600/50 text-white font-medium py-2 px-4 rounded-lg transition-colors flex items-center space-x-2",children:[ne.jsx(S,{className:"w-4 h-4"}),ne.jsx("span",{children:"Shuffle"})]}),p.size>0&&ne.jsxs("button",{onClick:U,disabled:c,className:"bg-green-600 hover:bg-green-700 disabled:bg-green-600/50 text-white font-medium py-2 px-4 rounded-lg transition-colors flex items-center space-x-2",children:[ne.jsx(z,{className:"w-4 h-4"}),ne.jsx("span",{children:"Download All"})]})]}),h.length>0&&ne.jsxs("div",{children:[ne.jsxs("h4",{className:"text-md font-medium text-white mb-3",children:["Résultats de recherche (",h.length," vidéos",R.length!==h.length?` • ${R.length} affichées`:"",")"]}),0===R.length?ne.jsxs("div",{className:"text-center py-8 text-slate-400",children:[ne.jsx(K,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),ne.jsx("p",{children:"Aucune vidéo ne correspond aux filtres"}),ne.jsx("button",{onClick:L,className:"text-blue-400 hover:text-blue-300 text-sm mt-2 underline",children:"Réinitialiser les filtres"})]}):ne.jsx("div",{className:"grid grid-cols-6 gap-2 max-h-[600px] overflow-y-auto custom-scrollbar",children:R.map(e=>ne.jsxs("div",{className:"relative group bg-slate-800/50 rounded-lg overflow-hidden border border-slate-600/50 hover:border-slate-500 transition-colors",children:[ne.jsx("div",{className:"aspect-[9/16] relative",children:ne.jsx("img",{src:e.thumbnail,alt:e.title,className:"w-full h-full object-cover"})}),ne.jsxs("div",{className:"p-2",children:[ne.jsx("div",{className:"text-xs text-white font-medium truncate mb-1",children:e.title}),ne.jsxs("div",{className:"text-xs text-slate-400 flex items-center space-x-1",children:[ne.jsxs("span",{children:[e.duration,"s"]}),ne.jsx("span",{children:"•"}),ne.jsx("button",{onClick:()=>P(e.author.name),className:"hover:text-blue-400 transition-colors underline decoration-dotted "+(w===e.author.name?"text-blue-400 font-medium":""),title:`Filtrer par ${e.author.name}`,children:e.author.name})]})]}),ne.jsx("div",{className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:ne.jsxs("div",{className:"text-center",children:[ne.jsx("div",{className:"text-xs text-white mb-2 font-medium",children:"Assigner au plan:"}),ne.jsx("div",{className:"flex flex-wrap justify-center gap-1",children:Array.from({length:k},(e,t)=>t+1).map(t=>{var s;return ne.jsx("button",{onClick:()=>((e,t)=>{const s=new Map(p);s.set(e,t),g(s),a(s)})(t,e),className:"w-6 h-6 rounded text-xs font-bold transition-colors "+((null==(s=p.get(t))?void 0:s.id)===e.id?"bg-green-500 text-white shadow-lg":"bg-slate-600 text-white hover:bg-blue-500"),children:t},t)})})]})})]},e.id))}),v&&!c&&ne.jsx("div",{className:"flex justify-center mt-4",children:ne.jsx("button",{onClick:O,className:"bg-slate-600 hover:bg-slate-500 text-white font-medium py-2 px-6 rounded-lg transition-colors flex items-center space-x-2",children:ne.jsx("span",{children:"Load 30 more videos"})})}),c&&f>1&&ne.jsx("div",{className:"flex justify-center mt-4",children:ne.jsxs("div",{className:"text-slate-400 text-sm flex items-center space-x-2",children:[ne.jsx("div",{className:"w-4 h-4 border-2 border-slate-400 border-t-transparent rounded-full animate-spin"}),ne.jsx("span",{children:"Loading more videos..."})]})})]}),p.size>0&&ne.jsxs("div",{children:[ne.jsxs("h4",{className:"text-md font-medium text-white mb-3",children:["Vidéos assignées (",p.size,"/",k," plans)"]}),ne.jsx("div",{className:"space-y-2",children:Array.from(p.entries()).map(([e,t])=>ne.jsxs("div",{className:"flex items-center justify-between bg-slate-800/50 rounded-lg p-3 border border-slate-600/50",children:[ne.jsxs("div",{className:"flex items-center space-x-3",children:[ne.jsx("div",{className:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center text-white text-sm font-bold",children:e}),ne.jsx("img",{src:t.thumbnail,alt:t.title,className:"w-12 h-8 object-cover rounded"}),ne.jsxs("div",{children:[ne.jsx("div",{className:"text-sm text-white font-medium truncate max-w-[200px]",children:t.title}),ne.jsxs("div",{className:"text-xs text-slate-400",children:[t.duration,"s • ",t.author.name]})]})]}),ne.jsx("button",{onClick:()=>(e=>{const t=new Map(p);t.delete(e),g(t),a(t)})(e),className:"text-red-400 hover:text-red-300 p-1",children:ne.jsx(F,{className:"w-4 h-4"})})]},e))})]})]}):ne.jsx("div",{className:"bg-slate-700/30 rounded-xl p-4 border border-slate-600/30",children:ne.jsxs("button",{onClick:()=>n(!0),className:"w-full bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 text-white font-semibold py-3 px-6 rounded-xl transition-all duration-200 flex items-center justify-center space-x-2",children:[ne.jsx(W,{className:"w-5 h-5"}),ne.jsx("span",{children:"Add Pexel Videos"})]})})};const Ze=new class{constructor(){this.currentAssignments=new Map,this.availableVideos=[],this.currentTheme="travel"}async assignVideosToPlans(e,t,s=!1,a){if(this.currentTheme===t&&!s&&this.currentAssignments.size>0)return this.currentAssignments;this.currentTheme=t;try{a&&a.length>0&&a.join(", ");if(this.availableVideos=await Ce.getVideosByTheme(t,!1,a),0===this.availableVideos.length)return this.currentAssignments;const s=e.length+1;this.currentAssignments.clear();for(let e=1;e<=s;e++){const t=this.selectVideoForPlan(e,s);t&&this.currentAssignments.set(e,t)}return this.currentAssignments}catch(r){return this.currentAssignments}}selectVideoForPlan(e,t){if(0===this.availableVideos.length)return null;const s=()=>this.availableVideos.find(e=>e.tags.some(e=>["action","movement","dynamic","people"].includes(e.toLowerCase())))||this.availableVideos[Math.floor(this.availableVideos.length/2)],a=()=>this.availableVideos.find(e=>e.tags.some(e=>["sunset","peaceful","ending","beautiful"].includes(e.toLowerCase())))||this.availableVideos[this.availableVideos.length-1],r=e=>{const t=(e-1)%this.availableVideos.length;return this.availableVideos[t]};return 1===e?(()=>this.availableVideos.find(e=>e.tags.some(e=>["travel","landscape","adventure","city"].includes(e.toLowerCase())))||this.availableVideos[0])():e===t&&t>2?a():t>4&&e===Math.ceil(t/2)?s():r(e)}getVideoForPlan(e){return this.currentAssignments.get(e)||null}getAllAssignments(){return new Map(this.currentAssignments)}getAssignmentStats(){return{totalPlans:this.currentAssignments.size,currentTheme:this.currentTheme,availableVideos:this.availableVideos.length,assignments:Array.from(this.currentAssignments.entries()).map(([e,t])=>({planIndex:e,videoTitle:t.title,videoId:t.id,videoDuration:Math.round(t.duration),videoTags:t.tags.slice(0,3)}))}}reassignVideoToPlan(e,t){const s=this.availableVideos.find(e=>e.id===t);return!!s&&(this.currentAssignments.set(e,s),!0)}shuffleAssignments(){if(0===this.availableVideos.length)return this.currentAssignments;const e=Array.from(this.currentAssignments.keys()),t=[...this.availableVideos].sort(()=>Math.random()-.5);return e.forEach((e,s)=>{const a=t[s%t.length];this.currentAssignments.set(e,a)}),this.currentAssignments}clearAssignments(){this.currentAssignments.clear(),this.availableVideos=[]}getAvailableVideos(){return[...this.availableVideos]}previewAssignment(e,t){const s=e.length+1,a=this.availableVideos.length,r=[];for(let n=1;n<=Math.min(s,5);n++){const e=this.selectVideoForPlan(n,s);r.push({planIndex:n,videoTitle:(null==e?void 0:e.title)||"No video available"})}return{planCount:s,availableVideos:a,previewAssignments:r}}},Qe=Object.freeze(Object.defineProperty({__proto__:null,planVideoAssigner:Ze},Symbol.toStringTag,{value:"Module"})),et=["#F97316","#3B82F6","#10B981","#8B5CF6","#EF4444","#F59E0B"];function tt(){const[e,t]=x.useState(null),[s,a]=x.useState(!1),[r,n]=x.useState([]),[i,l]=x.useState([]),[o,d]=x.useState({currentTime:0,isPlaying:!1,zoom:1,startTime:0,endTime:0}),[c,m]=x.useState(!1),[h,u]=x.useState(!1),[p,g]=x.useState("Travel"),[v,j]=x.useState(!1),[w,y]=x.useState(new Map),[N,T]=x.useState(new Map),S=x.useCallback(e=>{a(!0),t(e),d(t=>({...t,startTime:0,endTime:e.duration,currentTime:0,isPlaying:!1,zoom:1})),l([]),n([]),a(!1)},[]),C=x.useCallback(e=>{n(e)},[]),E=x.useCallback(t=>{if(!e)return;const s=i.find(e=>e.time>t),a=s?Math.min(s.time-t,1):1,r={id:crypto.randomUUID(),time:t,color:et[i.length%et.length],duration:a};l(e=>[...e,r].sort((e,t)=>e.time-t.time))},[e,i]),k=x.useCallback(e=>{l(t=>t.filter(t=>t.id!==e))},[]),M=x.useCallback((e,t)=>{l(s=>s.map(s=>s.id===e?{...s,time:t}:s).sort((e,t)=>e.time-t.time))},[]),R=x.useCallback(e=>{d(t=>({...t,currentTime:e}))},[]),A=x.useCallback(()=>{d(e=>({...e,isPlaying:!e.isPlaying}))},[]),L=x.useCallback(()=>{d(e=>({...e,isPlaying:!1,currentTime:e.startTime}))},[]),P=x.useCallback(()=>{m(e=>!e)},[]),F=x.useCallback((e,t)=>{d(s=>({...s,startTime:e,endTime:t}))},[]),_=x.useCallback(e=>{d(t=>({...t,zoom:e}))},[]),D=x.useCallback(()=>{u(!0)},[]),U=x.useCallback(()=>{u(!1)},[]),I=x.useCallback(t=>{if(!e||0===r.length)return;const s=Y({startTime:o.startTime,endTime:o.endTime,planCount:t,beatMarkers:r,minCutInterval:.8,prioritizeStrongBeats:!0});l(s),u(!1)},[e,r,o.startTime,o.endTime]);x.useCallback(async(e,t)=>{g(e),j(!0);try{await Ce.getVideosByTheme(e,!0,t);const s=await Ze.assignVideosToPlans(i,e,!0,t);y(s);t&&t.length>0&&t.join(", ")}catch(s){}finally{j(!1)}},[i]);const $=x.useCallback(e=>{y(e)},[]),V=x.useCallback((e,t,s)=>{T(a=>{const r=new Map(a);return r.set(e,{startTime:t,endTime:s}),r})},[]);x.useEffect(()=>{e&&Ce.preloadPopularThemes().catch(e=>{})},[e]),x.useEffect(()=>{o.currentTime<o.startTime&&d(e=>({...e,currentTime:e.startTime}))},[o.currentTime,o.startTime]),x.useEffect(()=>{const t=t=>{if(!e)return;const s=document.activeElement;if(!(s&&("INPUT"===s.tagName||"TEXTAREA"===s.tagName||"SELECT"===s.tagName||"true"===s.getAttribute("contenteditable"))))switch(t.code){case"Space":t.preventDefault(),A();break;case"KeyC":t.preventDefault(),E(o.currentTime);break;case"KeyI":t.preventDefault(),d(e=>({...e,startTime:e.currentTime}));break;case"KeyO":t.preventDefault(),d(e=>({...e,endTime:e.currentTime}));break;case"KeyL":t.preventDefault(),P();break;case"ArrowLeft":t.preventDefault(),R(Math.max(0,o.currentTime-.1));break;case"ArrowRight":t.preventDefault(),R(Math.min(e.duration,o.currentTime+.1));break;case"KeyR":t.preventDefault(),D()}};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[e,o,A,E,R,P]);return ne.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900",children:[ne.jsx("header",{className:"border-b border-slate-700/50 bg-slate-900/80 backdrop-blur-sm sticky top-0 z-50",children:ne.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:ne.jsxs("div",{className:"flex items-center justify-between h-16",children:[ne.jsxs("div",{className:"flex items-center space-x-3",children:[ne.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-600 rounded-xl flex items-center justify-center shadow-lg",children:ne.jsx(O,{className:"w-5 h-5 text-white"})}),ne.jsxs("div",{children:[ne.jsx("h1",{className:"text-xl font-bold text-white",children:"Snapcut Beat Editor"}),ne.jsx("p",{className:"text-xs text-slate-400",children:"Create beat-synced video templates"})]})]}),e&&ne.jsxs("button",{onClick:()=>{t(null),l([]),n([]),d({currentTime:0,isPlaying:!1,zoom:1,startTime:0,endTime:0}),m(!1),u(!1),g("Travel"),j(!1),T(new Map)},className:"flex items-center space-x-2 px-4 py-2 bg-slate-700 hover:bg-slate-600 rounded-lg transition-colors text-sm font-medium text-white",children:[ne.jsx(f,{className:"w-4 h-4"}),ne.jsx("span",{children:"New Project"})]})]})})}),e?ne.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[ne.jsxs("div",{className:"grid grid-cols-1 2xl:grid-cols-4 gap-6",children:[ne.jsxs("div",{className:"2xl:col-span-3 space-y-6",children:[ne.jsx("div",{className:"bg-slate-800/50 backdrop-blur-sm rounded-2xl border border-slate-700/50 p-6 shadow-xl",children:ne.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[ne.jsxs("div",{className:"flex items-center space-x-3 min-w-0",children:[ne.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-orange-500 to-red-500 rounded-xl flex items-center justify-center shadow-lg flex-shrink-0",children:ne.jsx(b,{className:"w-6 h-6 text-white"})}),ne.jsxs("div",{className:"min-w-0",children:[ne.jsx("h2",{className:"text-lg font-semibold text-white truncate",children:e.name}),ne.jsxs("p",{className:"text-sm text-slate-400",children:[Math.floor(e.duration/60),":",Math.floor(e.duration%60).toString().padStart(2,"0")]})]})]}),ne.jsx("div",{className:"flex-shrink-0",children:ne.jsx(oe,{audioFile:e,currentTime:o.currentTime,isPlaying:o.isPlaying,onTimeUpdate:R,onPlayPause:A,startTime:o.startTime,endTime:o.endTime,isLooping:c})})]})}),ne.jsx("div",{className:"bg-slate-800/50 backdrop-blur-sm rounded-2xl border border-slate-700/50 shadow-xl overflow-hidden",children:ne.jsx(de,{audioFile:e,currentTime:o.currentTime,isPlaying:o.isPlaying,beatMarkers:r,cutMarkers:i,startTime:o.startTime,endTime:o.endTime,onBeatDetected:C,onAddCut:E,onRemoveCut:k,onMoveCut:M,onSeek:R,onTrimChange:F,zoom:o.zoom,onZoomChange:_,onStop:L,isLooping:c,onToggleLoop:P,onRandomMode:D})})]}),ne.jsxs("div",{className:"2xl:col-span-1 space-y-6",children:[ne.jsx("div",{className:"bg-slate-800/50 backdrop-blur-sm rounded-2xl border border-slate-700/50 p-6 shadow-xl",children:ne.jsx(he,{cutMarkers:i,currentTime:o.currentTime,currentTheme:p,startTime:o.startTime,endTime:o.endTime,videoAssignments:w,onVideoAssignmentsChange:$,audioDuration:(null==e?void 0:e.duration)||0,onVideoTrimChange:V,videoTrimSettings:N})}),ne.jsx(Je,{cutMarkers:i,startTime:o.startTime,endTime:o.endTime,onVideoAssignmentsChange:$}),ne.jsx("div",{className:"bg-slate-800/50 backdrop-blur-sm rounded-2xl border border-slate-700/50 p-6 shadow-xl",children:ne.jsx(pe,{audioFile:e,cutMarkers:i,startTime:o.startTime,endTime:o.endTime,videoAssignments:w})})]})]}),e&&ne.jsx("div",{className:"mt-8",children:ne.jsx(Xe,{audioFile:e,cutMarkers:i,startTime:o.startTime,endTime:o.endTime,videoAssignments:w,videoTrimSettings:N})})]}):ne.jsx("div",{className:"flex items-center justify-center min-h-[calc(100vh-4rem)] pb-8",children:ne.jsx("div",{className:"w-full max-w-2xl mx-auto px-4",children:ne.jsx(le,{onAudioLoad:S,isLoading:s})})}),ne.jsx(ge,{isOpen:h,onClose:U,onGenerate:I,hasInOutPoints:o.startTime<o.endTime&&o.endTime>o.startTime+1,startTime:o.startTime,endTime:o.endTime,duration:(null==e?void 0:e.duration)||0,existingCutsCount:i.length}),ne.jsx(Ee,{})]})}re(document.getElementById("root")).render(ne.jsx(x.StrictMode,{children:ne.jsx(tt,{})}));
//# sourceMappingURL=index-mPfPezV-.js.map
